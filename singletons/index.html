<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-primitives/singletons" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Singletons | Chialisp</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://chialisp.com/singletons/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Singletons | Chialisp"><meta data-rh="true" name="description" content="Singletons allow you to keep track of the state of something on the blockchain, with the ability to verify and check any part of its history using a unique id. It proves that the puzzle is unique and cannot be duplicated. Singletons can use any arbitrary inner puzzle, and is used to make NFTs, DIDs, the pooling puzzle, and many other things possible."><meta data-rh="true" property="og:description" content="Singletons allow you to keep track of the state of something on the blockchain, with the ability to verify and check any part of its history using a unique id. It proves that the puzzle is unique and cannot be duplicated. Singletons can use any arbitrary inner puzzle, and is used to make NFTs, DIDs, the pooling puzzle, and many other things possible."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://chialisp.com/singletons/"><link data-rh="true" rel="alternate" href="https://chialisp.com/singletons/" hreflang="en"><link data-rh="true" rel="alternate" href="https://chialisp.com/singletons/" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Singletons","item":"https://chialisp.com/singletons"}]}</script><script src="/js/matomo.js" async defer="defer"></script><link rel="stylesheet" href="/assets/css/styles.429b5699.css">
<script src="/assets/js/runtime~main.b8c90d4b.js" defer="defer"></script>
<script src="/assets/js/main.1d740562.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Chialisp Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="Chialisp Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Chialisp</b></a><a href="https://docs.chia.net" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Chia Docs<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><a href="https://docs.chia.net/academy-home/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Chia Academy<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://chia.net" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Chia.net<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><a href="https://github.com/Chia-Network/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input searchInput_YFbd" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/chialisp-primer/">Chialisp Primer</a><button aria-label="Expand sidebar category &#x27;Chialisp Primer&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/chialisp-concepts/">Chialisp Concepts</a><button aria-label="Expand sidebar category &#x27;Chialisp Concepts&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/commands/">Commands</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/syntax/">Syntax</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/modern-chialisp/">Modern Chialisp</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/operators/">Operators</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/examples/">Examples</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/costs/">Costs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/conditions/">Conditions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/optimization/">Optimization</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/common_issues/">Common Issues</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/debugging/">Debugging</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/standard-transactions/">Primitives</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/standard-transactions/">Standard Transactions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/singletons/">Singletons</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cats/">CATs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/nfts/">NFTs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dids/">DIDs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/offers/">Offers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pooling/">Pooling</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/clvm/">CLVM</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Primitives</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Singletons</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Singletons</h1></header><p>Singletons allow you to keep track of the state of something on the blockchain, with the ability to verify and check any part of its history using a unique id. It proves that the puzzle is unique and cannot be duplicated. Singletons can use any arbitrary inner puzzle, and is used to make NFTs, DIDs, the pooling puzzle, and many other things possible.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="code-examples">Code Examples<a href="#code-examples" class="hash-link" aria-label="Direct link to Code Examples" title="Direct link to Code Examples">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="chia-blockchain">chia-blockchain<a href="#chia-blockchain" class="hash-link" aria-label="Direct link to chia-blockchain" title="Direct link to chia-blockchain">​</a></h3>
<p>The official Chia wallet has a reference implementation for the following in Python:</p>
<ul>
<li><a href="https://github.com/Chia-Network/chia-blockchain/blob/e07f9196ffd8fcb6d6e7e9dc9079f2bb9bcfe464/chia/wallet/nft_wallet/nft_wallet.py#L777" target="_blank" rel="noopener noreferrer">Create singleton solution</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="chia-rs">chia-rs<a href="#chia-rs" class="hash-link" aria-label="Direct link to chia-rs" title="Direct link to chia-rs">​</a></h3>
<p>Wallet code can use the following reference methods:</p>
<ul>
<li><a href="https://github.com/Chia-Network/chia_rs/blob/wallet-dev/chia-primitives/src/primitives/singleton.rs" target="_blank" rel="noopener noreferrer">Puzzle and solution types</a></li>
<li><a href="https://github.com/Chia-Network/chia_rs/blob/2334c842f694444da317fa7432f308f159f62d70/chia-wallet/src/wallet.rs#L1130" target="_blank" rel="noopener noreferrer">Create singleton solution</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="code">Singleton Code<a href="#code" class="hash-link" aria-label="Direct link to Singleton Code" title="Direct link to Singleton Code">​</a></h2>
<p>This is the source code of the singleton, which can also be found in the chia-blockchain repository in the puzzle <a href="https://github.com/Chia-Network/chia-blockchain/blob/8b70466a70388d0fff437d138192ba38faf92be8/chia/wallet/puzzles/singleton_top_layer_v1_1.clvm" target="_blank" rel="noopener noreferrer"><code>singleton_top_layer_v1_1.clvm</code></a>.</p>
<p>An explanation is provided within the dropdown:</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Expand Singleton Puzzle</summary><div><div class="collapsibleContent_i85q"><div class="language-chialisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#383a42;--prism-background-color:#fafafa"><div class="codeBlockTitle_OeMC">singleton_top_layer_v1_1.clvm</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-chialisp codeBlock_bY9V thin-scrollbar" style="color:#383a42;background-color:#fafafa;font-weight:bold"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">(mod (SINGLETON_STRUCT INNER_PUZZLE lineage_proof my_amount inner_solution)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">;; SINGLETON_STRUCT = (MOD_HASH . (LAUNCHER_ID . LAUNCHER_PUZZLE_HASH))</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">; SINGLETON_STRUCT, INNER_PUZZLE are curried in by the wallet</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">; EXAMPLE SOLUTION &#x27;(0xfadeddab 0xdeadbeef 1 (0xdeadbeef 200) 50 ((51 0xfadeddab 100) (60 &quot;trash&quot;) (51 deadbeef 0)))&#x27;</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">; This puzzle is a wrapper around an inner smart puzzle which guarantees uniqueness.</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">; It takes its singleton identity from a coin with a launcher puzzle which guarantees that it is unique.</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  (include condition_codes.clvm)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  (include curry-and-treehash.clinc)  ; also imports the constant ONE == 1</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  (include singleton_truths.clib)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  (include utility_macros.clib)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  (defun-inline mod_hash_for_singleton_struct (SINGLETON_STRUCT) (f SINGLETON_STRUCT))</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  (defun-inline launcher_id_for_singleton_struct (SINGLETON_STRUCT) (f (r SINGLETON_STRUCT)))</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  (defun-inline launcher_puzzle_hash_for_singleton_struct (SINGLETON_STRUCT) (r (r SINGLETON_STRUCT)))</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  ;; return the full puzzlehash for a singleton with the innerpuzzle curried in</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  ; puzzle-hash-of-curried-function is imported from curry-and-treehash.clinc</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  (defun-inline calculate_full_puzzle_hash (SINGLETON_STRUCT inner_puzzle_hash)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">     (puzzle-hash-of-curried-function (mod_hash_for_singleton_struct SINGLETON_STRUCT)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">                                      inner_puzzle_hash</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">                                      (sha256tree SINGLETON_STRUCT)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">     )</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  (defun-inline morph_condition (condition SINGLETON_STRUCT)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    (c (f condition) (c (calculate_full_puzzle_hash SINGLETON_STRUCT (f (r condition))) (r (r condition))))</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  (defun is_odd_create_coin (condition)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    (and (= (f condition) CREATE_COIN) (logand (f (r (r condition))) 1))</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  ; Assert exactly one output with odd value exists - ignore it if value is -113</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  ;; this function iterates over the output conditions from the inner puzzle &amp; solution</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  ;; and both checks that exactly one unique singleton child is created (with odd valued output),</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  ;; and wraps the inner puzzle with this same singleton wrapper puzzle</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  ;;</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  ;; The special case where the output value is -113 means a child singleton is intentionally</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  ;; *NOT* being created, thus forever ending this singleton&#x27;s existence</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  (defun check_and_morph_conditions_for_singleton (SINGLETON_STRUCT conditions has_odd_output_been_found)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    (if conditions</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">        ; check if it&#x27;s an odd create coin</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">        (if (is_odd_create_coin (f conditions))</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">            ; check that we haven&#x27;t already found one</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">            (assert (not has_odd_output_been_found)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">              ; then</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">              (if (= (f (r (r (f conditions)))) -113)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">                  ; If it&#x27;s the melt condition we don&#x27;t bother prepending this condition</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">                  (check_and_morph_conditions_for_singleton SINGLETON_STRUCT (r conditions) ONE)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">                  ; If it isn&#x27;t the melt condition, we morph it and prepend it</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">                  (c (morph_condition (f conditions) SINGLETON_STRUCT) (check_and_morph_conditions_for_singleton SINGLETON_STRUCT (r conditions) ONE))</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">              )</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">            )</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">            (c (f conditions) (check_and_morph_conditions_for_singleton SINGLETON_STRUCT (r conditions) has_odd_output_been_found))</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">        (assert has_odd_output_been_found ())</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">   )</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain"> ; assert that either the lineage proof is for a parent singleton, or, if it&#x27;s for the launcher, verify it matched our launcher ID</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain"> ; then return a condition asserting it actually is our parent ID</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain"> (defun verify_lineage_proof (SINGLETON_STRUCT parent_id is_not_launcher)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    (assert (any is_not_launcher (= parent_id (launcher_id_for_singleton_struct SINGLETON_STRUCT)))</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">      ; then</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">      (list ASSERT_MY_PARENT_ID parent_id)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain"> )</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  ; main</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  ; if our value is not an odd amount then we are invalid</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  (assert (logand my_amount ONE)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    ; then</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    (c</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">      (list ASSERT_MY_AMOUNT my_amount)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">      (c</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">        ; Verify the lineage proof by asserting our parent&#x27;s ID</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">        (verify_lineage_proof</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">          SINGLETON_STRUCT</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">          ; calculate our parent&#x27;s ID</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">          (calculate_coin_id</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">            (parent_info_for_lineage_proof lineage_proof)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">            (if (is_not_eve_proof lineage_proof)  ; The PH calculation changes based on the lineage proof</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">              (calculate_full_puzzle_hash SINGLETON_STRUCT (puzzle_hash_for_lineage_proof lineage_proof))  ; wrap the innerpuz in a singleton</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">              (launcher_puzzle_hash_for_singleton_struct SINGLETON_STRUCT) ; Use the static launcher puzzle hash</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">            )</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">            (if (is_not_eve_proof lineage_proof)  ; The position of &quot;amount&quot; changes based on the type on lineage proof</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">              (amount_for_lineage_proof lineage_proof)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">              (amount_for_eve_proof lineage_proof)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">            )</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">          )</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">          (is_not_eve_proof lineage_proof)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">        ; finally check all of the conditions for a single odd output to wrap</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">        (check_and_morph_conditions_for_singleton SINGLETON_STRUCT (a INNER_PUZZLE inner_solution) 0)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">)</span><br></span></code></pre></div></div><p>Quite a bit isn&#x27;t it? Let&#x27;s start with the arguments:</p><div class="language-chialisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#383a42;--prism-background-color:#fafafa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-chialisp codeBlock_bY9V thin-scrollbar" style="color:#383a42;background-color:#fafafa;font-weight:bold"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">(</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  SINGLETON_STRUCT</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  INNER_PUZZLE</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  lineage_proof</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  my_amount</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  inner_solution</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">)</span><br></span></code></pre></div></div><p><code>SINGLETON_STRUCT</code> is a collection of three things:</p><ul>
<li>The tree hash of this module</li>
<li>The launcher coin id (this acts as the unique id for the singleton)</li>
<li>The launcher puzzle hash</li>
</ul><p>The reason they are grouped into a single structure is because they are passed through almost every function. It increases readability and optimization if they are passed through as a single variable until it is time to deconstruct them.</p><p><code>INNER_PUZZLE</code> is the inner puzzle to this wrapper puzzle.</p><p><code>lineage_proof</code> takes one of two formats:</p><ul>
<li><code>(parent_parent_coin_info parent_inner_puzzle_hash parent_amount)</code></li>
<li><code>(parent_parent_coin_info parent_amount)</code>
You may wonder, given the similarity, why not just use the first format? We use the separate formats because we use the length of the structure to tip us off to whether or not this is the <strong>eve spend</strong>.
The eve spend is the first spend of a singleton after its creation.
We use this lineage proof to verify that our parent was a singleton.
However, in the first spend, the parent is not a singleton and we actually execute a different path where we verify that our parent was a singleton launcher instead.</li>
</ul><p><code>my_amount</code> is the amount of the coin being spent and will be asserted implicitly through ASSERT_MY_COIN_ID.</p><p><code>inner_solution</code> is the solution the to inner puzzle.</p><p>Next, let&#x27;s look at our main entry point:</p><div class="language-chialisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#383a42;--prism-background-color:#fafafa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-chialisp codeBlock_bY9V thin-scrollbar" style="color:#383a42;background-color:#fafafa;font-weight:bold"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">(if (logand my_amount 1)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  (stager_one SINGLETON_STRUCT lineage_proof (sha256tree INNER_PUZZLE) my_amount INNER_PUZZLE inner_solution)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  (x)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">)</span><br></span></code></pre></div></div><p>The control flow here is very simple.
If we&#x27;re not odd, we raise, if we are, we pass everything through to the next stage (with the additional hash of the inner puzzle).
One small thing to note is that a singleton can actually be even, but it will never be able to be spent.
Either the person will pass in the true amount and the puzzle will raise, or they will pass in a phony amount and the ASSERT_MY_ID will fail. If an attacker were to launch an even singleton or create one as one the even children of the singleton, it would succeed, but be stuck forever.</p><div class="language-chialisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#383a42;--prism-background-color:#fafafa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-chialisp codeBlock_bY9V thin-scrollbar" style="color:#383a42;background-color:#fafafa;font-weight:bold"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">(defun stager_one (SINGLETON_STRUCT lineage_proof my_innerpuzhash my_amount INNER_PUZZLE inner_solution)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  (stager_two SINGLETON_STRUCT lineage_proof (calculate_full_puzzle_hash SINGLETON_STRUCT my_innerpuzhash) my_innerpuzhash my_amount INNER_PUZZLE inner_solution)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">)</span><br></span></code></pre></div></div><p>We now move on to the first of a few &quot;stagers&quot;. The purpose of these functions is to calculate values that are used multiple times only once.
In the next stage we use our full puzzle hash three times so it&#x27;s best to calculate it once and pass it to the next function instead.</p><div class="language-chialisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#383a42;--prism-background-color:#fafafa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-chialisp codeBlock_bY9V thin-scrollbar" style="color:#383a42;background-color:#fafafa;font-weight:bold"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">(defun stager_two (SINGLETON_STRUCT lineage_proof full_puzhash innerpuzhash my_amount INNER_PUZZLE inner_solution)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  (stager_three</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    SINGLETON_STRUCT</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    lineage_proof</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    (if (is_not_eve_proof lineage_proof)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">        (create_my_ID</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">          SINGLETON_STRUCT</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">          full_puzhash</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">          (parent_info_for_lineage_proof lineage_proof)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">          (puzzle_hash_for_lineage_proof lineage_proof)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">          (amount_for_lineage_proof lineage_proof)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">          my_amount</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">        (if (=</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">              (launcher_id_for_singleton_struct SINGLETON_STRUCT)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">              (sha256 (parent_info_for_eve_proof lineage_proof) (launcher_puzzle_hash_for_singleton_struct SINGLETON_STRUCT) (amount_for_eve_proof lineage_proof))</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">            )</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">            (sha256 (launcher_id_for_singleton_struct SINGLETON_STRUCT) full_puzhash my_amount)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">            (x)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    full_puzhash</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    innerpuzhash</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    my_amount</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    INNER_PUZZLE</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    inner_solution</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">)</span><br></span></code></pre></div></div><p>This stage looks like a lot, but really all it&#x27;s doing is calculating the current coin id for the next function to use.
Note before we start looking at it that the lineage proof is frequently being passed to functions that are not part of this file.
These are part of the <code>singleton_truths.clib</code> library which we will discuss in the next stage.
For now, just know that it is accessing the correct values from the lineage proof and is a lot cleaner than writing things like <code>(f (r lineage_proof)) (f (r (r lineage_proof)))</code> with no indication of what they mean.</p><p>The first if statement checks if <code>lineage_proof</code> indicates that this is not the eve spend (three proof elements instead of two).
If it is not the eve spend, it calculates our id using the information in the <code>lineage_proof</code> to generate our parent id.</p><p>If it <em>is</em> the eve spend, there is an extra check which verifies that the launcher id and launcher puzzle hash we have (both inside the <code>SINGLETON_STRUCT</code>) are correct. We do so by calculating the launcher id from information in our lineage proof and the launcher puzzle hash.
We then assert that it is equal to the curried in value.
This is an extremely important step because it ensures that every singleton after this singleton can trust the launcher id and puzzle hash since it will be forcefully curried in from this &quot;eve&quot; singleton and every child singleton knows that the eve singleton checked it.</p><p>After the eve singleton has verified the launcher info, it can now trust the launcher id as its parent id and create its own id by hashing in the <code>full_puzhash</code> from the last stage and <code>my_amount</code>.
Let&#x27;s talk about the final &quot;stager&quot;:</p><div class="language-chialisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#383a42;--prism-background-color:#fafafa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-chialisp codeBlock_bY9V thin-scrollbar" style="color:#383a42;background-color:#fafafa;font-weight:bold"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">(defun stager_three (SINGLETON_STRUCT lineage_proof my_id full_puzhash innerpuzhash my_amount INNER_PUZZLE inner_solution)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  (c (list ASSERT_MY_COIN_ID my_id) (check_and_morph_conditions_for_singleton SINGLETON_STRUCT (a INNER_PUZZLE (c (truth_data_to_truth_struct my_id full_puzhash innerpuzhash my_amount lineage_proof SINGLETON_STRUCT) inner_solution)) 0))</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">)</span><br></span></code></pre></div></div><p>This stage is where the conditions will end up coming out of.
First, it prepends an <code>ASSERT_MY_COIN_ID</code> so that all of the solution values we have been assuming to be true up until this point are implicitly asserted by the network.
We prepend this condition to the output of <code>check_and_morph_conditions_for_singleton</code> which will take the output from the inner puzzle and check for singleton specific things (only one odd output, wrap the child singleton, etc.)</p><p>Notice that we are prepending something to the solution before we use it to solve the inner puzzle.
We are using a function from <code>singleton_truths.clib</code> that takes all of the listed information and combines it into a single structure to pass to the inner puzzle.
This allows the inner puzzle to use information that the singleton has already calculated and verified in its own puzzle at almost no additional cost!</p><p>Keep in mind that this means an inner puzzle needs to know that it is going inside a singleton or else all of its solution arguments will be shifted to the right.
An existing inner puzzle can be very easily adapted, however, to fit inside a singleton using a shallow outer layer of: <code>(a (q . INNER_PUZZLE) (r 1))</code> which strips off the first value of the solution before solving the inner puzzle.</p><div class="language-chialisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#383a42;--prism-background-color:#fafafa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-chialisp codeBlock_bY9V thin-scrollbar" style="color:#383a42;background-color:#fafafa;font-weight:bold"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">(defun check_and_morph_conditions_for_singleton (SINGLETON_STRUCT conditions has_odd_output_been_found)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  (if conditions</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    (morph_next_condition SINGLETON_STRUCT conditions has_odd_output_been_found (odd_cons_m113 (created_coin_value_or_0 (f conditions))))</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    (if has_odd_output_been_found</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">        0</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">        (x)  ;; no odd output found</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">(defun morph_next_condition (SINGLETON_STRUCT conditions has_odd_output_been_found (is_output_odd . is_output_m113))</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">   (assert</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">      (not (all is_output_odd has_odd_output_been_found))</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">      (strip_first_condition_if</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">         is_output_m113</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">         (c (if is_output_odd</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">                (morph_condition (f conditions) SINGLETON_STRUCT)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">                (f conditions)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">            )</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">            (check_and_morph_conditions_for_singleton SINGLETON_STRUCT (r conditions) (any is_output_odd has_odd_output_been_found))</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">         )</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">)</span><br></span></code></pre></div></div><p>This section is a bit unique in that it recurses by handing values back and forth to each other.
Our main entry point is through the first block: <code>check_and_morph_conditions_for_singleton</code> which checks first if we still have conditions.
If we don&#x27;t, we check to see if the <code>has_odd_output_been_found</code> flag has been set and raise if it hasn&#x27;t been.</p><p>If we do have remaining conditions, we pass them to the next function along with the results of checking the first condition to see if it is a <code>CREATE_COIN</code> whose output is odd or the melt value.</p><p>In <code>morph_next_condition</code> we first assert that we have not found a second odd output.
If we have, we raise.
If we have not already run into an odd output, we head to a rather confusing section of the control flow.
The outermost function call essentially waits for the final recursive output and strips out the melt condition if it was found.
That recursive output is generated by taking the first condition, wrapping it in a singleton outer puzzle if it&#x27;s odd, and then passing the rest of the conditions back to <code>check_and_morph_conditions_for_singleton</code> with the <code>has_odd_output_been_found</code> flag set if relevant.</p></div></div></details>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="design-decisions">Design Decisions<a href="#design-decisions" class="hash-link" aria-label="Direct link to Design Decisions" title="Direct link to Design Decisions">​</a></h2>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="odd">Singleton amount is odd<a href="#odd" class="hash-link" aria-label="Direct link to Singleton amount is odd" title="Direct link to Singleton amount is odd">​</a></h4>
<p>In order to assure that a singleton does not duplicate itself, it needs some way to verify that its children do not consist of more than one new singleton. It does this by verifying that only one of its children is odd. It can either be the new singleton coin or the value to be melted. It&#x27;s odd so that you can output other non-singleton coins that are multiples of 10, such as a full XCH.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="wrapped">Odd child is wrapped<a href="#wrapped" class="hash-link" aria-label="Direct link to Odd child is wrapped" title="Direct link to Odd child is wrapped">​</a></h4>
<p>This abstracts some of the singleton functionality away from the inner puzzles. If an inner puzzle creates an odd coin, it doesn&#x27;t have to worry about making it a singleton. It also prevents an inner puzzle from accidentally melting the singleton by forgetting to wrap its output.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="melt">Melt condition determines wrapping<a href="#melt" class="hash-link" aria-label="Direct link to Melt condition determines wrapping" title="Direct link to Melt condition determines wrapping">​</a></h4>
<p>If you would like to melt a singleton and use its amount to create a new coin, you need to output a <code>CREATE_COIN</code> condition that uses the amount <code>-113</code>. When the singleton outer puzzle sees that condition, it filters it out.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="launcher">Launcher<a href="#launcher" class="hash-link" aria-label="Direct link to Launcher" title="Direct link to Launcher">​</a></h2>
<p>The singleton launcher is used to ensure only one is created with the same id, since usually any coin could create the singleton, or multiple thereof. It does exactly one thing, which is creating a single singleton.</p>
<p>Additionally, the singleton&#x27;s id is used for referencing it, as well as any metadata associated with it that is stored and can&#x27;t be changed later.</p>
<p>This is the source code, which can also be found in the chia-blockchain repository in the puzzle <a href="https://github.com/Chia-Network/chia-blockchain/blob/fad414132e6950e79e805629427af76bf9ddcbc5/chia/wallet/puzzles/singleton_launcher.clvm" target="_blank" rel="noopener noreferrer"><code>singleton_launcher.clvm</code></a>.</p>
<p>An explanation is provided within the dropdown:</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Singleton Launcher</summary><div><div class="collapsibleContent_i85q"><div class="language-chialisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#383a42;--prism-background-color:#fafafa"><div class="codeBlockTitle_OeMC">singleton_launcher.clvm</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-chialisp codeBlock_bY9V thin-scrollbar" style="color:#383a42;background-color:#fafafa;font-weight:bold"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">(mod (singleton_full_puzzle_hash amount key_value_list)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">(include condition_codes.clvm)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">; takes a lisp tree and returns the hash of it</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">(defun sha256tree1 (TREE)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">(if (l TREE)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">(sha256 2 (sha256tree1 (f TREE)) (sha256tree1 (r TREE)))</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">(sha256 1 TREE)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">; main</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">(list (list CREATE_COIN singleton_full_puzzle_hash amount)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">(list CREATE_COIN_ANNOUNCEMENT (sha256tree1 (list singleton_full_puzzle_hash amount key_value_list))))</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div><p>Essentially two lines, so not too bad right? One of the first things you may notice is that we don&#x27;t curry anything in.
We actually cannot curry anything in because we want this puzzle hash to be constant among all singletons.
That way, even if someone isn&#x27;t familiar with us, they know that if we came from this specific launcher puzzle hash, we can be trusted to be a unique singleton.</p><p>For the most part, you simply put in <code>CREATE_COIN</code> parameters and the puzzle creates the singleton for you.
The tricky part is the announcement creation.
Since these parameters are not curried in, we somehow need them to be immune from the manipulations of malicious full nodes.
We cannot curry in a pubkey to sign them, or else our puzzle hash is no longer static. Our solution to this conundrum is to create an announcement from this puzzle that its parent asserts in the same block.
Usually, the parent is going to be a standard coin. In the standard coin, we sign the puzzle that makes the conditions.
If we create an <code>ASSERT_COIN_ANNOUNCEMENT</code> condition, we implicitly sign that too. That means we can implicitly sign all of the launcher solution values through asserting this announcement.
If any of those values are changed, the coin that creates the launcher will fail and thus the launcher will never be created!</p><p>The last thing to note is the seemingly useless <code>key_value_list</code> that is passed in as an argument and announced.
The purpose for this is to communicate information to blockchain observers.
Sometimes you want to be able to know information about a puzzle before it is revealed.
The only way we can get this information on chain is from the parent&#x27;s puzzle reveal so sometimes it is useful to have useless parameters be part of the solution in order to make it easier to follow the puzzle&#x27;s on chain state.
Remember that you pay cost for every byte though so keep it concise.</p></div></div></details>
<p>This launcher puzzle hash (which is the same for all singletons) is curried into the singleton, which then asserts that it came from a parent whose puzzle hash matches the launcher. This prevents it from being falsified, and can be verified without crawling back up to the original coin.</p>
<p>In addition to creating the singleton, the launcher announces the tree hash of its solution, effectively ensuring that they are signed and cannot be tampered with by malicious full nodes. The reason this works is that the parent (which has a signature) asserts as being valid in the same block. If any of the values change, the parent of the launcher coin will fail, and thus it will never create the singleton.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="pay-to-singleton">Pay to Singleton<a href="#pay-to-singleton" class="hash-link" aria-label="Direct link to Pay to Singleton" title="Direct link to Pay to Singleton">​</a></h2>
<p>Now that you understand how a singleton functions, we can now look at an example of paying to a singleton (locking up a coin in such a way that only the owner of a specific singleton can unlock it).</p>
<p>The idea is that you curry in the necessary information to calculate the singleton&#x27;s puzzle hash and then assert an announcement from the singleton that says that it is time to claim the funds locked up in the puzzle. Since the puzzle hash will be unique to that singleton (due to the launcher id being curried in), only that singleton will be able to create the appropriate announcement.</p>
<p>This is the source code, which can also be found in the chia-blockchain repository in the puzzle <a href="https://github.com/Chia-Network/chia-blockchain/blob/fad414132e6950e79e805629427af76bf9ddcbc5/chia/wallet/puzzles/p2_singleton.clvm" target="_blank" rel="noopener noreferrer"><code>p2_singleton</code></a>.</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Pay to Singleton</summary><div><div class="collapsibleContent_i85q"><div class="language-chialisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#383a42;--prism-background-color:#fafafa"><div class="codeBlockTitle_OeMC">p2_singleton.clvm</div><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-chialisp codeBlock_bY9V thin-scrollbar" style="color:#383a42;background-color:#fafafa;font-weight:bold"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">(mod (</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">       SINGLETON_MOD_HASH</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">       LAUNCHER_ID</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">       LAUNCHER_PUZZLE_HASH</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">       singleton_inner_puzzle_hash</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">       my_id</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">     )</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  ; SINGLETON_MOD_HASH is the mod-hash for the singleton_top_layer puzzle</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  ; LAUNCHER_ID is the ID of the singleton we are commited to paying to</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  ; LAUNCHER_PUZZLE_HASH is the puzzle hash of the launcher</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  ; singleton_inner_puzzle_hash is the innerpuzzlehash for our singleton at the current time</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  ; my_id is the coin_id of the coin that this puzzle is locked into</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  (include condition_codes.clvm)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  (include curry-and-treehash.clinc)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  ; takes a lisp tree and returns the hash of it</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  (defun sha256tree (TREE)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">      (if (l TREE)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">          (sha256 2 (sha256tree (f TREE)) (sha256tree (r TREE)))</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">          (sha256 1 TREE)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  ;; return the full puzzlehash for a singleton with the innerpuzzle curried in</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  ; puzzle-hash-of-curried-function is imported from curry-and-treehash.clinc</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  (defun-inline calculate_full_puzzle_hash (SINGLETON_MOD_HASH LAUNCHER_ID LAUNCHER_PUZZLE_HASH inner_puzzle_hash)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">     (puzzle-hash-of-curried-function SINGLETON_MOD_HASH</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">                                      inner_puzzle_hash</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">                                      (sha256tree (c SINGLETON_MOD_HASH (c LAUNCHER_ID LAUNCHER_PUZZLE_HASH)))</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">     )</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  (defun-inline claim_rewards (SINGLETON_MOD_HASH LAUNCHER_ID LAUNCHER_PUZZLE_HASH singleton_inner_puzzle_hash my_id)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    (list</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">        (list ASSERT_PUZZLE_ANNOUNCEMENT (sha256 (calculate_full_puzzle_hash SINGLETON_MOD_HASH LAUNCHER_ID LAUNCHER_PUZZLE_HASH singleton_inner_puzzle_hash) my_id))</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">        (list CREATE_COIN_ANNOUNCEMENT &#x27;$&#x27;)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">        (list ASSERT_MY_COIN_ID my_id))</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  ; main</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  (claim_rewards SINGLETON_MOD_HASH LAUNCHER_ID LAUNCHER_PUZZLE_HASH singleton_inner_puzzle_hash my_id)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">)</span><br></span></code></pre></div></div><p>Most of this puzzle should be self explanatory especially if you&#x27;ve gone through the puzzles above.
Let focus on just the conditions we are creating from the <code>claim_rewards</code> function:</p><div class="language-chialisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#383a42;--prism-background-color:#fafafa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-chialisp codeBlock_bY9V thin-scrollbar" style="color:#383a42;background-color:#fafafa;font-weight:bold"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">(list</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    (list ASSERT_PUZZLE_ANNOUNCEMENT (sha256 (calculate_full_puzzle_hash SINGLETON_MOD_HASH LAUNCHER_ID LAUNCHER_PUZZLE_HASH singleton_inner_puzzle_hash) my_id))</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    (list CREATE_COIN_ANNOUNCEMENT &#x27;$&#x27;)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    (list ASSERT_MY_COIN_ID my_id)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">)</span><br></span></code></pre></div></div><p>We are both asserting an announcement from the singleton and creating one for it.
The assertion is fundamental to the fact that we only want to be claimed by a very specific singleton.
Due to the launcher id being curried into the singleton&#x27;s puzzle hash, it will be unique to every singleton and can thereby only be claimed by the singleton whose launcher id we specify.
We cannot use the singleton&#x27;s coin id, because if we curried that in, the singleton could spend and then this puzzle becomes unsolvable!</p><p>The announcement that we create is simply for the singleton to assert that we are also being spent.
This is necessary due to the fact that <a href="https://docs.chia.net/coin-set-security#replay" target="_blank" rel="noopener noreferrer">nodes may try and exclude this spend</a> causing the singleton to spend without claiming these rewards.
Since this coin cannot be signed, we must ensure somehow that if it is excluded, the whole spend bundle fails.
We use <code>&#x27;$&#x27;</code> because it&#x27;s one byte and somewhat relevant.</p><p>The coin id assertion is simply to ensure that we are being told the truth about our id. Otherwise, we could piggy back on another claim by using that coin&#x27;s id and asserting the announcement that the singleton creates for it.</p></div></div></details>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">​</a></h2>
<p>The singleton is a very useful primitive that is used to power higher level things such as NFTs and DIDs. It can be used to emulate state using a linear chain of coins. This is a less centralized version of a typical smart contract.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/Chia-Network/chialisp-web/blob/main/docs/primitives/singletons.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/standard-transactions/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Standard Transactions</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/cats/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">CATs</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#code-examples" class="table-of-contents__link toc-highlight">Code Examples</a><ul><li><a href="#chia-blockchain" class="table-of-contents__link toc-highlight">chia-blockchain</a></li><li><a href="#chia-rs" class="table-of-contents__link toc-highlight">chia-rs</a></li></ul></li><li><a href="#code" class="table-of-contents__link toc-highlight">Singleton Code</a></li><li><a href="#design-decisions" class="table-of-contents__link toc-highlight">Design Decisions</a></li><li><a href="#launcher" class="table-of-contents__link toc-highlight">Launcher</a></li><li><a href="#pay-to-singleton" class="table-of-contents__link toc-highlight">Pay to Singleton</a></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/operators/">Operators</a></li><li class="footer__item"><a class="footer__link-item" href="/clvm/">CLVM</a></li><li class="footer__item"><a href="https://docs.chia.net" target="_blank" rel="noopener noreferrer" class="footer__link-item">Chia Docs<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discord.gg/chia" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://twitter.com/chia_project" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.chia.net/blog/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/Chia-Network/clvm" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a class="footerLogoLink_BH7S" href="/"><img src="/img/full_logo_white.svg" alt="Chialisp full logo" class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/full_logo_white.svg" alt="Chialisp full logo" class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU"></a></div><div class="footer__copyright">© 2025 Chia Network Inc., Licensed under the <a href="https://github.com/Chia-Network/chialisp-web/blob/main/LICENSE" target="_blank">Apache License, Version 2.0</a> | <a href="https://www.chia.net/terms">Terms</a></div></div></div></footer></div>
</body>
</html>