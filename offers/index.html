<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-primitives/offers" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.1">
<title data-rh="true">Offers | Chialisp</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://chialisp.com/offers/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Offers | Chialisp"><meta data-rh="true" name="description" content="Offers are a way to enable peer-to-peer asset exchange on the Chia blockchain. In other words, you can swap tokens without needing to go through an exchange. Only two parties are required, the maker and the taker. They don&#x27;t need to trust each other, since any attempts to modify the offer will invalidate it."><meta data-rh="true" property="og:description" content="Offers are a way to enable peer-to-peer asset exchange on the Chia blockchain. In other words, you can swap tokens without needing to go through an exchange. Only two parties are required, the maker and the taker. They don&#x27;t need to trust each other, since any attempts to modify the offer will invalidate it."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://chialisp.com/offers/"><link data-rh="true" rel="alternate" href="https://chialisp.com/offers/" hreflang="en"><link data-rh="true" rel="alternate" href="https://chialisp.com/offers/" hreflang="x-default"><script src="/js/matomo.js" async defer="defer"></script><link rel="stylesheet" href="/assets/css/styles.52370c4f.css">
<script src="/assets/js/runtime~main.c255185d.js" defer="defer"></script>
<script src="/assets/js/main.f6c3fb7d.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Chialisp Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="Chialisp Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Chialisp</b></a><a href="https://docs.chia.net" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Chia Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://docs.chia.net/academy-home/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Chia Academy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><a href="https://chia.net" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Chia.net<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/Chia-Network/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/chialisp-primer/">Chialisp Primer</a><button aria-label="Expand sidebar category &#x27;Chialisp Primer&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/chialisp-concepts/">Chialisp Concepts</a><button aria-label="Expand sidebar category &#x27;Chialisp Concepts&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/commands/">Commands</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/syntax/">Syntax</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/modern-chialisp/">Modern Chialisp</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/operators/">Operators</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/examples/">Examples</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/costs/">Costs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/conditions/">Conditions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/optimization/">Optimization</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/common_issues/">Common Issues</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/debugging/">Debugging</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/standard-transactions/">Primitives</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/standard-transactions/">Standard Transactions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/singletons/">Singletons</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cats/">CATs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/nfts/">NFTs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dids/">DIDs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/offers/">Offers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/pooling/">Pooling</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/clvm/">CLVM</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Primitives</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Offers</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Offers</h1></header><p>Offers are a way to enable peer-to-peer asset exchange on the Chia blockchain. In other words, you can swap tokens without needing to go through an exchange. Only two parties are required, the maker and the taker. They don&#x27;t need to trust each other, since any attempts to modify the offer will invalidate it.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="code-examples">Code Examples<a href="#code-examples" class="hash-link" aria-label="Direct link to Code Examples" title="Direct link to Code Examples">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="chia-blockchain">chia-blockchain<a href="#chia-blockchain" class="hash-link" aria-label="Direct link to chia-blockchain" title="Direct link to chia-blockchain">​</a></h3>
<p>The official Chia wallet has a reference implementation for the following in Python:</p>
<ul>
<li><a href="https://github.com/Chia-Network/chia-blockchain/blob/010cedf83718aa8e4d97da76f892fe69387a5d82/chia/wallet/trade_manager.py#L410" target="_blank" rel="noopener noreferrer">Offer multiple assets</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="chia-rs">chia-rs<a href="#chia-rs" class="hash-link" aria-label="Direct link to chia-rs" title="Direct link to chia-rs">​</a></h3>
<p>The wallet code used by the <a href="https://github.com/Chia-Network/MonsterSprouts" target="_blank" rel="noopener noreferrer">MonsterSprouts example game</a> has the following reference methods:</p>
<ul>
<li><a href="https://github.com/Chia-Network/chia_rs/blob/2334c842f694444da317fa7432f308f159f62d70/chia-wallet/src/wallet.rs#L101" target="_blank" rel="noopener noreferrer">Offer NFT1 for CAT2</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="offer-files">Offer Files<a href="#offer-files" class="hash-link" aria-label="Direct link to Offer Files" title="Direct link to Offer Files">​</a></h2>
<p>When you create an offer, you get a string of text that is usually stored in a file. This describes the details of the trade, including the assets you are requesting and the assets you are giving in return. This file can be published on various platforms and downloaded by anyone to fulfill in the wallet of their choice. This allows for the flexibility of exchanges, while keeping it fully decentralized and preventing tampering or relying on a third party or middleman.</p>
<p>You can use a wallet to generate an offer file for a given trade, then distribute that offer to platforms such as the following:</p>
<ul>
<li><a href="https://dexie.space" target="_blank" rel="noopener noreferrer">Dexie</a></li>
<li><a href="https://offerpool.io" target="_blank" rel="noopener noreferrer">OfferPool</a></li>
<li><a href="https://offerbin.io" target="_blank" rel="noopener noreferrer">OfferBin</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="code">Settlement Payments Code<a href="#code" class="hash-link" aria-label="Direct link to Settlement Payments Code" title="Direct link to Settlement Payments Code">​</a></h2>
<p>This is the source code of the settlement payments puzzle, which can also be found in the chia-blockchain repository in the puzzle <a href="https://github.com/Chia-Network/chia-blockchain/blob/8224d2fd657780b224a1fc40d3081ce734d70016/chia/wallet/puzzles/settlement_payments.clsp" target="_blank" rel="noopener noreferrer"><code>settlement_payments.clvm</code></a>.</p>
<details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Expand Settlement Payments Puzzle</summary><div><div class="collapsibleContent_i85q"><div class="language-chialisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#383a42;--prism-background-color:#fafafa"><div class="codeBlockTitle_Ktv7">settlement_payments.clvm</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-chialisp codeBlock_bY9V thin-scrollbar" style="color:#383a42;background-color:#fafafa;font-weight:bold"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">(mod notarized_payments</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  ;; `notarized_payments` is a list of notarized coin payments</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  ;; a notarized coin payment is `(nonce . ((puzzle_hash amount ...) (puzzle_hash amount ...) ...))`</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  ;; Each notarized coin payment creates some `(CREATE_COIN puzzle_hash amount ...)` payments</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  ;; and a `(CREATE_PUZZLE_ANNOUNCEMENT (sha256tree notarized_coin_payment))` announcement</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  ;; The idea is the other side of this trade requires observing the announcement from a</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  ;; `settlement_payments` puzzle hash as a condition of one or more coin spends.</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  (include condition_codes.clib)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  (include utility_macros.clib)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  (defun sha256tree (TREE)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    (if (l TREE)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">        (sha256 2 (sha256tree (f TREE)) (sha256tree (r TREE)))</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">        (sha256 1 TREE)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  (defun create_coins_for_payment (payment_params so_far)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    (if payment_params</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">        (assert (&gt; (f (r (f payment_params))) 0)  ; assert the amount is positive</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">          ; then</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">          (c (c CREATE_COIN (f payment_params)) (create_coins_for_payment (r payment_params) so_far))</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">        so_far</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  (defun-inline create_announcement_for_payment (notarized_payment)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    (list CREATE_PUZZLE_ANNOUNCEMENT</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    (sha256tree notarized_payment))</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  (defun-inline augment_condition_list (notarized_payment so_far)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    (c</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">      (create_announcement_for_payment notarized_payment)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">      (create_coins_for_payment (r notarized_payment) so_far)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  (defun construct_condition_list (notarized_payments)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    (if notarized_payments</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">        (augment_condition_list (f notarized_payments) (construct_condition_list (r notarized_payments)))</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">        ()</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  (construct_condition_list notarized_payments)</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></details>
<p>Offers use the settlement payments puzzle. Its solution is a list of <code>notarized_payments</code>.</p>
<p>The <code>notarized_payments</code> are structured like this:</p>
<div class="language-chialisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#383a42;--prism-background-color:#fafafa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-chialisp codeBlock_bY9V thin-scrollbar" style="color:#383a42;background-color:#fafafa;font-weight:bold"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">((N . ((PH1 AMT1 ...) (PH2 AMT2 ...) (PH3 AMT3 ...))) ...)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li><code>N</code> is the nonce</li>
<li><code>PH1</code> is the puzzle hash of the first coin</li>
<li><code>AMT1</code> is the amount (or value) of the coin being offered</li>
<li><code>...</code> is an optional memo</li>
</ul>
<p>For each set of notarized coin payments, this puzzle creates one <code>CREATE_PUZZLE_ANNOUNCEMENT</code> condition. For each coin payment within this set, the puzzle creates one <code>CREATE_COIN</code> condition.</p>
<p>The reason for creating these conditions is to match the announcements created in the offer file. The <code>settlement_payments</code> puzzle is quite versatile, as it can be used as an inner puzzle inside a CAT or NFT, as a puzzle to spend regular XCH, or in order to spend any other assets in Chia&#x27;s ecosystem.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="design-decisions">Design Decisions<a href="#design-decisions" class="hash-link" aria-label="Direct link to Design Decisions" title="Direct link to Design Decisions">​</a></h2>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="announcements">Settlement announces required payments<a href="#announcements" class="hash-link" aria-label="Direct link to Settlement announces required payments" title="Direct link to Settlement announces required payments">​</a></h4>
<p>The settlement payments puzzle announces the payments that are required for the transaction to complete, so that it will fail if either party cannot complete their end of the bargain.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="nonspecific">Offers trade by puzzle not specific coins<a href="#nonspecific" class="hash-link" aria-label="Direct link to Offers trade by puzzle not specific coins" title="Direct link to Offers trade by puzzle not specific coins">​</a></h4>
<p>Payments must be of a certain puzzle with a certain value in mojos, rather than a specific coin. This allows a part of a coin to be sent back as change, and the remainder left up to the offer to claim as its value.</p>
<p>Another benefit of doing it this way is that anyone can accept the offer, rather than it being between two specific parties.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="aggregation">It is possible to aggregate offers<a href="#aggregation" class="hash-link" aria-label="Direct link to It is possible to aggregate offers" title="Direct link to It is possible to aggregate offers">​</a></h4>
<p>An Automated Market Maker (AMM) can aggregate offers together and complete them simultaneously. This allows someone to request a large amount of a coin and multiple parties who have a smaller amount can complete the transaction. The small amounts add up to the amount requested, and the large amount of the offered value is divided amongst the smaller offers. As long as the terms of each offer are met, how you get there doesn&#x27;t matter.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="advantages">Advantages<a href="#advantages" class="hash-link" aria-label="Direct link to Advantages" title="Direct link to Advantages">​</a></h2>
<p>Offers have many properties that we think will make them a valuable tool for Chia&#x27;s community.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="secure">Secure<a href="#secure" class="hash-link" aria-label="Direct link to Secure" title="Direct link to Secure">​</a></h3>
<p>When using Chia offers, makers and takers retain control of their private keys, as well as their assets. By contrast, centralized exchanges require users to transfer their funds to an account that the exchange controls. If the exchange is hacked or simply goes out of business, users can lose their funds. With Chia offers, self-custody of keys and funds is assured.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>Offer files do not contain private keys or any way to deduce them.</p><p>If an offer file falls into a hacker&#x27;s hands, they only have two options like anyone else:</p><ul>
<li>Ignore the offer</li>
<li>Accept it</li>
</ul></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="immutable">Immutable<a href="#immutable" class="hash-link" aria-label="Direct link to Immutable" title="Direct link to Immutable">​</a></h3>
<p>Once an offer file is created, any alterations to the file will invalidate it.</p>
<p>The offer file only has two possible outcomes:</p>
<ol>
<li>The taker accepts the offer as-is and the transaction is processed</li>
<li>The maker cancels the offer</li>
</ol>
<p>The offer will be in a pending state until either outcome is fulfilled. It is possible that the offer never is completed or canceled.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>Takers are free to propose a counter offer by creating their own offer file. In this case, the original maker could cancel the original offer, and both parties&#x27; roles would be reversed.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="compliant">Compliant<a href="#compliant" class="hash-link" aria-label="Direct link to Compliant" title="Direct link to Compliant">​</a></h3>
<p>As offers are inherently peer-to-peer, they don&#x27;t constitute an exchange or other regulated market activity.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="trustless">Trustless<a href="#trustless" class="hash-link" aria-label="Direct link to Trustless" title="Direct link to Trustless">​</a></h3>
<p>Offers are <em>not</em> analogous to a handshake or a promise, where one party could renege on the trade. By using Chia offers, the maker and taker don&#x27;t need to trust each other. They don&#x27;t even need to <em>know</em> each other. As long as a taker matches the offer identically, the offer will be valid.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="simultaneous">Simultaneous<a href="#simultaneous" class="hash-link" aria-label="Direct link to Simultaneous" title="Direct link to Simultaneous">​</a></h3>
<p>The maker&#x27;s and taker&#x27;s transactions must happen in the same block. In Chia, all transactions conducted within a single block happen simultaneously. This eliminates one type of maximum extractable value (MEV), where validators can increase their fees by re-ordering transactions.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="non-custodial">Non-Custodial<a href="#non-custodial" class="hash-link" aria-label="Direct link to Non-Custodial" title="Direct link to Non-Custodial">​</a></h3>
<p>Neither the maker nor taker are required to send their funds to a trusted intermediary, such as an escrow service or an exchange. This removes the need for Over The Counter (OTC) desks and other middlemen, who require their customers to submit funds before they allow transactions to complete.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="commission-free">Commission-Free<a href="#commission-free" class="hash-link" aria-label="Direct link to Commission-Free" title="Direct link to Commission-Free">​</a></h3>
<p>Because offers don&#x27;t use escrow services or other middlemen, there are also none of the typical fees associated with those intermediaries. However, offers <em>are</em> subject to Chia blockchain transaction fees, just like all transactions.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="multi-asset">Multi-Asset<a href="#multi-asset" class="hash-link" aria-label="Direct link to Multi-Asset" title="Direct link to Multi-Asset">​</a></h3>
<p>A maker can create an offer for multiple assets on both ends of the offer. For example, they could offer 1 XCH and 1.75 CKC for 100,000 SBX and 3 MRMT.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="offer-states">Offer States<a href="#offer-states" class="hash-link" aria-label="Direct link to Offer States" title="Direct link to Offer States">​</a></h2>
<p>An offer has six potential states:</p>
<p><strong>PENDING_ACCEPT</strong> - The maker has created the offer, but a taker has not yet accepted it. The maker&#x27;s wallet has reserved the coin(s) to be spent. The spend bundle for the offer has not been sent to the mempool.</p>
<p><strong>PENDING_CONFIRM</strong> - The taker has accepted the offer. The taker&#x27;s wallet has reserved the coin(s) to be spent. The completed spend bundle has been sent to the mempool.</p>
<p><strong>PENDING_CANCEL</strong> - The maker has attempted to cancel the offer by spending the coins being offered. The completed spend bundle has been sent to the mempool.</p>
<p><strong>CANCELLED</strong> - Depending on which <a href="#cancellation">type of cancellation</a> has been used, either:</p>
<ul>
<li>The maker&#x27;s wallet has released the coins it had been reserving for this offer</li>
<li>The maker&#x27;s coins have been spent and new ones have been created in the maker&#x27;s wallet</li>
</ul>
<p><strong>CONFIRMED</strong> - The maker&#x27;s and taker&#x27;s reserved coins have been spent in the same spend bundle. The offer has been completed successfully.</p>
<p><strong>FAILED</strong> - The taker attempted, and failed to accept the offer. This could have happened either because the maker cancelled the offer, or because another taker took the offer first.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="cancellation">Cancellation<a href="#cancellation" class="hash-link" aria-label="Direct link to Cancellation" title="Direct link to Cancellation">​</a></h2>
<p>There are two ways to cancel an offer, depending on the circumstances.</p>
<p>If the offer is already publicly available, it will have to be cancelled on-chain. This is done by spending the coins involved in the offer to (which make the notarized payments invalid).</p>
<p>Otherwise, it is trivial to simply delete the offer or not share the file, as it is not stored anywhere publicly and therefore can&#x27;t be accepted.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="arbitrage">Arbitrage<a href="#arbitrage" class="hash-link" aria-label="Direct link to Arbitrage" title="Direct link to Arbitrage">​</a></h2>
<p>It is possible to accept an offer, then create or accept another offer in a way that you make a profit. This is known as arbitrage, and drives supply and demand. However, old offers are at risk unless they are cancelled because the price can change in the time it&#x27;s sitting around.</p>
<p>A possible solution for this is a price oracle, which would stabilize the prices and keep them up to date.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="market-makers">Market Makers<a href="#market-makers" class="hash-link" aria-label="Direct link to Market Makers" title="Direct link to Market Makers">​</a></h2>
<p>Offers in the <code>PENDING_CONFIRM</code> state have been added to the mempool. Farmers and third-party software can observe the current list of offers, and aggregate overlapping ones. This operation is known as a &quot;market maker.&quot;</p>
<p>Automated Market Makers (AMMs) are likely to appear in Chia&#x27;s ecosystem. AMMs can create a single settlement puzzle for each type of asset (for example XCH or a specific type of CAT), and aggregate all of the notarized coin payments of that type in the puzzle.</p>
<p>A taker is part offer-creator, part market-maker. A taker finds an offer of interest and constructs the other side of that offer, using both of the <code>settlement_payments</code> puzzles to resolve the cross-asset payments.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="offer-aggregation">Offer Aggregation<a href="#offer-aggregation" class="hash-link" aria-label="Direct link to Offer Aggregation" title="Direct link to Offer Aggregation">​</a></h3>
<p>A sophisticated AMM might aggregate multiple <code>settlement_payments</code> into a single spend, which means it could combine an arbitrary number of offers, paying through one <code>settlement_payments</code> ephemeral coin for each asset type.</p>
<p>For example, a whale wants to buy 10,000 XCH, and is currently sitting on a large stack of stablecoins. There aren&#x27;t any individuals willing to sell such a large amount of XCH, but the whale doesn&#x27;t need to create a bunch of small offers. Instead, they create a single offer: X stablecoins (at the current market price) for 10,000 XCH. Several small XCH holders can aggregate their holdings to complete the offer.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="creating-offer-files">Creating Offer Files<a href="#creating-offer-files" class="hash-link" aria-label="Direct link to Creating Offer Files" title="Direct link to Creating Offer Files">​</a></h2>
<p>Here&#x27;s the basic workflow to create an offer file:</p>
<ol>
<li>
<p>The maker uses either the wallet GUI or CLI to create the terms for an offer. For example, the maker might offer 1 XCH for 251 CKC. If the maker doesn&#x27;t have sufficient funds, an error is thrown.</p>
</li>
<li>
<p>The maker&#x27;s wallet selects the appropriate coin(s) to spend, starting with the largest coin available.</p>
</li>
<li>
<p>For each coin the maker wants to receive from the offer, the maker&#x27;s wallet creates a notarized coin payment. This is a list in the form of <code>(PH1 AMT1 ...)</code>, where:</p>
<ul>
<li><code>PH1</code> is the puzzle hash of the coin the maker wants to acquire.</li>
<li><code>AMT1</code> is the value of the coin the maker wants to acquire.</li>
<li><code>...</code> is an optional memo of arbitrary length. The trade manager adds a hint to itself in this memo.</li>
</ul>
</li>
<li>
<p>The maker&#x27;s wallet creates a nonce <code>N</code>, using the treehash of a sorted list of the coinIDs of each coin being offered.</p>
</li>
</ol>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_BuS1"><p>If you&#x27;re unfamiliar with them, Wikipedia has a good explanation of <a href="https://en.wikipedia.org/wiki/Cryptographic_nonce" target="_blank" rel="noopener noreferrer">Cryptographic nonces</a>.</p></div></div>
<p>Every coin id needs to be included in the nonce to prevent the maker from creating two offers that can both be completed with just one payment.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>Even if two conflicting offers were created, the blockchain would correctly reject one of them as a double-spend.</p></div></div>
<p>Because each coin id must be unique, any attempts to change any of the coins being offered will cause the offer to become invalid.</p>
<ol start="5">
<li>The maker&#x27;s wallet combines the nonce with the notarized coin payment(s) to create a list called <code>notarized_payments</code>. For example, if three coins are included in the maker&#x27;s offer, <code>notarized_payments</code> will be structured like this:</li>
</ol>
<div class="language-chialisp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#383a42;--prism-background-color:#fafafa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-chialisp codeBlock_bY9V thin-scrollbar" style="color:#383a42;background-color:#fafafa;font-weight:bold"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">((N . ((PH1 AMT1 ...) (PH2 AMT2 ...) (PH3 AMT3 ...))) ...)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="6">
<li>
<p>The offer driver calculates the announcements that need to be asserted in order to get paid.</p>
</li>
<li>
<p>The maker&#x27;s wallet creates a spend bundle paying the puzzle hash of the settlement payments puzzle. Finally, the offer file is created, using <code>notarized_payments</code> and the spendbundle.</p>
</li>
<li>
<p>The offer file is now complete. The maker can send this file anywhere others might see it, including social media, message boards, or a website dedicated to maintaining a list of current offers.</p>
</li>
<li>
<p>The offer&#x27;s status is now <code>PENDING_ACCEPT</code>. In order for the offer to be completed, it still requires a <code>CREATE_PUZZLE_ANNOUNCEMENT</code> condition for the whole puzzle, and a <code>CREATE_COIN</code> condition for each type of asset to be received. The maker&#x27;s coin(s) can&#x27;t be spent until a taker creates these conditions.</p>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="accepting-offer-files">Accepting Offer Files<a href="#accepting-offer-files" class="hash-link" aria-label="Direct link to Accepting Offer Files" title="Direct link to Accepting Offer Files">​</a></h2>
<p>The offer file can be named anything, and it contains a bech32 address for an incomplete spend bundle.</p>
<p>The taker still must perform several steps before the offer can be confirmed:</p>
<p><strong>View the Offer</strong> - The taker needs to validate the terms of the offer before choosing whether to accept it. This can be done using either Chia&#x27;s wallet GUI or the CLI. In either case, the taker can choose whether to load the offer file or paste its contents.</p>
<p><strong>Validate the Offer</strong> - When the offer is loaded into the taker&#x27;s wallet, the wallet verifies that the offer is valid by checking that the Maker&#x27;s coins have not been spent. If any coins have been spent, the wallet will show an error that the offer is no longer valid. If the offer is still valid, the taker&#x27;s wallet displays the offer&#x27;s terms and asks whether the taker will accept it.</p>
<p><strong>Create a Spend Bundle</strong> - If the taker accepts, then the taker&#x27;s wallet creates a new spend bundle with a combination of both the maker&#x27;s and taker&#x27;s ends of the offer. The offer&#x27;s status is now <code>PENDING_CONFIRM</code>.</p>
<p><strong>Push the Spend Bundle</strong> - The taker&#x27;s wallet pushes the spendbundle to the blockchain. After the spend bundle succeeds, all of the relevant coins have been spent or created, and all assertions have been completed. At this point, the offer&#x27;s status is <code>CONFIRMED</code>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="conclusion">Conclusion<a href="#conclusion" class="hash-link" aria-label="Direct link to Conclusion" title="Direct link to Conclusion">​</a></h2>
<p>Offers are a refreshing new way to swap tokens in a decentralized way without a third party exchange or placing trust in others. They can be shared in any method you choose and accepted by anyone without worrying about the offer being tampered with.</p>
<p>For additional details on how Offers work, see <a href="https://aggsig.me/offers.html" target="_blank" rel="noopener noreferrer">this article</a>.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/Chia-Network/chialisp-web/blob/main/docs/primitives/offers.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/dids/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">DIDs</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/pooling/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Pooling</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#code-examples" class="table-of-contents__link toc-highlight">Code Examples</a><ul><li><a href="#chia-blockchain" class="table-of-contents__link toc-highlight">chia-blockchain</a></li><li><a href="#chia-rs" class="table-of-contents__link toc-highlight">chia-rs</a></li></ul></li><li><a href="#offer-files" class="table-of-contents__link toc-highlight">Offer Files</a></li><li><a href="#code" class="table-of-contents__link toc-highlight">Settlement Payments Code</a></li><li><a href="#design-decisions" class="table-of-contents__link toc-highlight">Design Decisions</a></li><li><a href="#advantages" class="table-of-contents__link toc-highlight">Advantages</a><ul><li><a href="#secure" class="table-of-contents__link toc-highlight">Secure</a></li><li><a href="#immutable" class="table-of-contents__link toc-highlight">Immutable</a></li><li><a href="#compliant" class="table-of-contents__link toc-highlight">Compliant</a></li><li><a href="#trustless" class="table-of-contents__link toc-highlight">Trustless</a></li><li><a href="#simultaneous" class="table-of-contents__link toc-highlight">Simultaneous</a></li><li><a href="#non-custodial" class="table-of-contents__link toc-highlight">Non-Custodial</a></li><li><a href="#commission-free" class="table-of-contents__link toc-highlight">Commission-Free</a></li><li><a href="#multi-asset" class="table-of-contents__link toc-highlight">Multi-Asset</a></li></ul></li><li><a href="#offer-states" class="table-of-contents__link toc-highlight">Offer States</a></li><li><a href="#cancellation" class="table-of-contents__link toc-highlight">Cancellation</a></li><li><a href="#arbitrage" class="table-of-contents__link toc-highlight">Arbitrage</a></li><li><a href="#market-makers" class="table-of-contents__link toc-highlight">Market Makers</a><ul><li><a href="#offer-aggregation" class="table-of-contents__link toc-highlight">Offer Aggregation</a></li></ul></li><li><a href="#creating-offer-files" class="table-of-contents__link toc-highlight">Creating Offer Files</a></li><li><a href="#accepting-offer-files" class="table-of-contents__link toc-highlight">Accepting Offer Files</a></li><li><a href="#conclusion" class="table-of-contents__link toc-highlight">Conclusion</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/operators/">Operators</a></li><li class="footer__item"><a class="footer__link-item" href="/clvm/">CLVM</a></li><li class="footer__item"><a href="https://docs.chia.net" target="_blank" rel="noopener noreferrer" class="footer__link-item">Chia Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discord.gg/chia" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/chia_project" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.chia.net/blog/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/Chia-Network/clvm" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a class="footerLogoLink_BH7S" href="/"><img src="/img/full_logo_white.svg" alt="Chialisp full logo" class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/full_logo_white.svg" alt="Chialisp full logo" class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU"></a></div><div class="footer__copyright">© 2024 Chia Network Inc., Licensed under the <a href="https://github.com/Chia-Network/chialisp-web/blob/main/LICENSE" target="_blank">Apache License, Version 2.0</a> | <a href="https://www.chia.net/terms">Terms</a></div></div></div></footer></div>
</body>
</html>