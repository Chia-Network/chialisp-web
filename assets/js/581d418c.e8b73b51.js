(self.webpackChunkchialisp_web=self.webpackChunkchialisp_web||[]).push([[905],{7811:(e,n,i)=>{"use strict";i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>u,frontMatter:()=>o,metadata:()=>t,toc:()=>h});const t=JSON.parse('{"id":"syntax","title":"Syntax","description":"Chialisp\'s syntax is based on Lisp, but there are some differences. This is a primer on the structure of expressions. Everything in the language shares the same S-expression syntax, including operators and functions.","source":"@site/docs/syntax.md","sourceDirName":".","slug":"/syntax","permalink":"/syntax","draft":false,"unlisted":false,"editUrl":"https://github.com/Chia-Network/chialisp-web/blob/main/docs/syntax.md","tags":[],"version":"current","frontMatter":{"id":"syntax","title":"Syntax","slug":"/syntax"},"sidebar":"someSidebar","previous":{"title":"Commands","permalink":"/commands"},"next":{"title":"Modern Chialisp","permalink":"/modern-chialisp"}}');var s=i(4848),r=i(8453),a=i(3823);const o={id:"syntax",title:"Syntax",slug:"/syntax"},l=void 0,c={},h=[{value:"Comments",id:"comments",level:2},{value:"Atoms",id:"atoms",level:2},{value:"Nil",id:"nil",level:3},{value:"Boolean Values",id:"boolean-values",level:3},{value:"Cons Pairs",id:"cons-pairs",level:2},{value:"List Termination",id:"list-termination",level:3},{value:"Quoting",id:"quoting",level:3},{value:"Quoting Evaluation",id:"quoting-evaluation",level:4},{value:"Destructuring",id:"destructuring",level:2},{value:"Include Files",id:"include-files",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.p,{children:["Chialisp's syntax is based on ",(0,s.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/Lisp_(programming_language)",children:"Lisp"}),", but there are some differences. This is a primer on the structure of expressions. Everything in the language shares the same ",(0,s.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/S-expression",children:"S-expression"})," syntax, including operators and functions."]}),"\n",(0,s.jsx)(n.h2,{id:"comments",children:"Comments"}),"\n",(0,s.jsx)(n.p,{children:"You can use one or more semicolons to denote that the rest of the line is a comment, and should be ignored when running the program."}),"\n",(0,s.jsx)(a.A,{flavor:"chialisp",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-chialisp",children:";;; This is a comment.\n\n(+ 3 2) ; This is also a comment.\n"})})}),"\n",(0,s.jsx)(n.p,{children:"Here are a few conventions for the number of semicolons to use:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"1 semicolon when right-aligned with code."}),"\n",(0,s.jsx)(n.li,{children:"2 semicolons when block-aligned with code."}),"\n",(0,s.jsx)(n.li,{children:"3 semicolons when top-level."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"atoms",children:"Atoms"}),"\n",(0,s.jsxs)(n.p,{children:["An atom is a ",(0,s.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/Endianness",children:"big endian"})," array of bytes. Atoms can be interpreted as either an integer or a raw byte string, depending on the operator."]}),"\n",(0,s.jsxs)(n.p,{children:["They are immutable, so any time an operator performs a calculation, it is creating a new atom for the result rather than reusing the original. This ensures that Chialisp is stateless and doesn't allow for ",(0,s.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/Side_effect_(computer_science)",children:"side effects"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"Although an atom is represented in the same way regardless of the data stored in it, it can be written and displayed in the following ways to make it more meaningful to the reader:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Decimal (e.g. ",(0,s.jsx)(n.code,{children:"100"}),")"]}),"\n",(0,s.jsxs)(n.li,{children:["Hexadecimal (e.g. ",(0,s.jsx)(n.code,{children:"0xFF"}),")"]}),"\n",(0,s.jsxs)(n.li,{children:["String (e.g. ",(0,s.jsx)(n.code,{children:'"xyz"'})," or ",(0,s.jsx)(n.code,{children:"'xyz'"}),")"]}),"\n",(0,s.jsxs)(n.li,{children:["Symbol (e.g. ",(0,s.jsx)(n.code,{children:"hello"}),")"]}),"\n"]}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsx)(n.p,{children:"When interpreting atoms as integers, it's important to remember that they are signed. In order to represent a positive integer, the most significant bit may not be set. Because of this, positive integers have a 0 byte prepended to them, in case the most significant bit in the next byte is set."})}),"\n",(0,s.jsx)(n.h3,{id:"nil",children:"Nil"}),"\n",(0,s.jsxs)(n.p,{children:["The value ",(0,s.jsx)(n.code,{children:"0"})," or ",(0,s.jsx)(n.code,{children:"()"})," is referred to as nil."]}),"\n",(0,s.jsx)(n.p,{children:"It can mean a few different things depending on the context:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Zero"}),"\n",(0,s.jsx)(n.li,{children:"False"}),"\n",(0,s.jsx)(n.li,{children:"Empty list"}),"\n",(0,s.jsx)(n.li,{children:"Empty bytes"}),"\n",(0,s.jsx)(n.li,{children:"List terminator"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"boolean-values",children:"Boolean Values"}),"\n",(0,s.jsx)(n.p,{children:"Some operators treat atoms as booleans."}),"\n",(0,s.jsxs)(n.p,{children:["While every atom is considered to be ",(0,s.jsx)(n.code,{children:"true"})," other than nil, the value is internally represented as ",(0,s.jsx)(n.code,{children:"1"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"cons-pairs",children:"Cons Pairs"}),"\n",(0,s.jsxs)(n.admonition,{type:"note",children:[(0,s.jsx)(n.p,{children:"Keep in mind that this is the syntax of the language itself. If you try to write a value as shown below, the language will interpret the first argument as an operator and throw an error."}),(0,s.jsxs)(n.p,{children:["Chances are, you want to use the ",(0,s.jsx)(n.code,{children:"list"})," operator or quote the value with ",(0,s.jsx)(n.code,{children:"q"})," instead, to prevent it from being interpreted as an operator."]})]}),"\n",(0,s.jsx)(n.p,{children:"A cons pair is a set of two values. A cons pair value looks like this:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"(first . rest)\n"})}),"\n",(0,s.jsx)(n.p,{children:"Because a value can be a cons pair itself, you can nest them in a chain:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-chialisp",children:"(1 . (2 . (3 . ())))\n"})}),"\n",(0,s.jsx)(n.p,{children:"When a chain of cons pairs ends in nil, it forms a proper list."}),"\n",(0,s.jsx)(n.p,{children:"This is the preferred way of writing the same thing, in list form:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-chialisp",children:"(1 2 3)\n"})}),"\n",(0,s.jsx)(n.h3,{id:"list-termination",children:"List Termination"}),"\n",(0,s.jsx)(n.p,{children:"A proper list is terminated with nil, but if you are using cons pairs as a struct of values rather than a list, you can choose not to terminate it with nil."}),"\n",(0,s.jsx)(n.p,{children:"Here is an example of a struct with three values:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-chialisp",children:"(1 2 . 3)\n"})}),"\n",(0,s.jsx)(n.p,{children:"Which is equivalent to the following:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-chialisp",children:"(1 . (2 . 3))\n"})}),"\n",(0,s.jsx)(n.h3,{id:"quoting",children:"Quoting"}),"\n",(0,s.jsx)(n.p,{children:"As previously mentioned, if you want to write a value using the syntax shown above, rather than a call to an operator, you need to use the quote operator. This treats an expression as a value rather than a program, preventing execution."}),"\n",(0,s.jsx)(n.p,{children:"Here is an example quotation of a list:"}),"\n",(0,s.jsx)(a.A,{flavor:"clvm",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-chialisp",children:"(q . (1 2 3))\n"})})}),"\n",(0,s.jsx)(n.p,{children:"Which is equivalent to the following Chialisp code:"}),"\n",(0,s.jsx)(a.A,{flavor:"chialisp",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-chialisp",children:"(list 1 2 3)\n"})})}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsx)(n.p,{children:"Because quotation prevents execution, any operators or constants used within will be left in the form they are written in rather than being replaced."})}),"\n",(0,s.jsx)(n.h4,{id:"quoting-evaluation",children:"Quoting Evaluation"}),"\n",(0,s.jsxs)(n.p,{children:["It's necessary to think about how clvm functions in order to fully understand ",(0,s.jsx)(n.code,{children:"q"}),'.  The evaluation process is basically the following:\n"If the current thing is an atom, evaluate it.  If the current thing is a pair, evaluate the thing on the right, and pass it as an argument to the operator on the left."']}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"q"}),' is one of two special operators in clvm.  Its job is basically to say, "don\'t evaluate the thing on the right, and just return it".  It puts an end to the recursive evaluation.']}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"qq"})," by itself does the same thing as ",(0,s.jsx)(n.code,{children:"q"}),".  When used with unquote it's like f-strings in python.  You don't want to evaluate the thing on the right, but you need to do some evaluation to generate it.\n",(0,s.jsx)(n.code,{children:'(qq ("don\'t evaluate me" . ("nor me" . (unquote "but this needs to be evaluated"))))'})]}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsxs)(n.p,{children:["The other special operator is ",(0,s.jsx)(n.code,{children:"a"})," which resets the environment before continuing with the evaluation."]})}),"\n",(0,s.jsx)(n.h2,{id:"destructuring",children:"Destructuring"}),"\n",(0,s.jsx)(n.p,{children:"Usually for things such as modules and functions, you will only need a list of parameters. However, more advanced behavior is possible for destructuring those arguments. In fact, you can write a named list, cons pair, or single atom in whatever structure you need, and it will automatically destructure the environment into the constants provided."}),"\n",(0,s.jsx)(n.p,{children:"This will capture the entire environment:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-chialisp",children:"(mod environment\n    ...\n)\n"})}),"\n",(0,s.jsx)(n.p,{children:"This will destructure an improper list:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-chialisp",children:"(mod (first second . third)\n    ...\n)\n"})}),"\n",(0,s.jsx)(n.p,{children:"And finally, this will unwrap a list within the list:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-chialisp",children:"(mod (first (second third))\n    ...\n)\n"})}),"\n",(0,s.jsx)(n.h2,{id:"include-files",children:"Include Files"}),"\n",(0,s.jsx)(n.p,{children:"You can write a set of utility functions, constants, and macros inside of a file to be included when needed in your Chialisp programs. This is known as an include file."}),"\n",(0,s.jsx)(n.p,{children:"They are structured as a list of definitions, like this:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-chialisp",children:"(\n    (defconstant ONE_HUNDRED 100)\n\n    (defun do-something-special ()\n        ONE_HUNDRED\n    )\n)\n"})})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},3823:(e,n,i)=>{"use strict";i.d(n,{A:()=>f});var t=i(5293),s=i(11),r=i(1765),a=i(6540),o=i(5604),l=i(6069),c=i.n(l),h=i(5871),d=i.n(h),u=i(9031),p=i.n(u);function m(e){return e instanceof Array||(0,a.isValidElement)(e)?a.Children.toArray(e).reduce(((e,n)=>{let i="";return i=(0,a.isValidElement)(n)&&g(n)?m(n.props.children):(0,a.isValidElement)(n)&&!g(n)?"":x(n),e.concat(i)}),""):x(e)}function x(e){return null==e||"boolean"==typeof e||"{}"===JSON.stringify(e)?"":e.toString()}function g(e){return(0,a.isValidElement)(e)&&Boolean(e.props.children)}var j=i(4848);function f(e){let{children:n,flavor:i,input:l,tests:c,reporter:h}=e;const{colorMode:u}=(0,t.G)(),x=(0,a.useMemo)((()=>m(n).trim()),[]),[g,f]=(0,a.useState)(x),[v,b]=(0,a.useState)(l??Object.keys(c??{})[0]?.trim()??""),[w,k]=(0,a.useState)(""),[C,S]=(0,a.useState)(0n),[N,T]=(0,a.useState)(null),q=e=>e.replace("Error: ",""),E=(e,n)=>{try{return e.run(n)}catch(i){return k(`While evaluating: ${q(""+i)}`),null}},A=()=>{const e=(()=>{try{return s.Program.fromSource(g)}catch(e){return k(`While parsing: ${q(""+e)}`),null}})();if(!e)return;const n="clvm"===i||e.isCons&&e.first.equals(s.Program.fromText("mod")),t=(e=>{if(i&&"chialisp"!==i)return e;try{return e.compile().value}catch(n){return k(`While compiling: ${q(""+n)}`),null}})(e);if(!t)return;const r=v?s.Program.fromSource(v):s.Program.nil,a=n?E(t,r):{value:t,cost:0n};a&&(k(a.value.toSource()),S(a.cost));let o=!0;for(const[i,l]of Object.entries(c??{})){const e=s.Program.fromSource(i),r=n?E(t,e)?.value:t;if(!r||r.toSource()!==l){o=!1;break}}h?.(o),T(o)},F=N?o.CMH:o.QCr,[W,P]=a.useState(!1);return(0,a.useEffect)((()=>P(!0)),[]),(0,j.jsx)(r.f4,{Prism:globalThis.Prism,theme:W&&("dark"===u?d():p()),code:g,language:"chialisp",children:e=>{let{className:n,style:t}=e;return(0,j.jsxs)("pre",{className:n,style:{...t,position:"relative"},children:[v?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(y,{code:v,setCode:b,language:"chialisp"}),(0,j.jsx)("hr",{style:{marginTop:"14px",marginBottom:"14px"}})]}):"",(0,j.jsx)(y,{code:g,setCode:f,language:"chialisp"}),(0,j.jsx)("div",{style:{position:"absolute",top:"16px",right:"16px"},children:(0,j.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"14px"},children:[(0,j.jsx)("span",{style:{marginRight:"8px"},children:i&&"chialisp"!==i?"CLVM":"Chialisp"}),!v&&(0,j.jsx)(o.TlQ,{size:24,className:"icon-button",cursor:"pointer",onClick:()=>b("()")}),(0,j.jsx)(o.gSK,{size:24,className:"icon-button",cursor:"pointer",onClick:A})]})}),w?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("hr",{style:{marginTop:"14px",marginBottom:"14px"}}),(0,j.jsx)("div",{style:{display:"inline-block"},children:(0,j.jsx)(y,{code:w,language:"chialisp"})}),w&&(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("div",{style:{display:"inline-block",position:"absolute",right:"60px"},children:(0,j.jsx)(y,{code:`Cost: ${C}`,language:"chialisp"})}),(0,j.jsx)(F,{size:24,color:N?"#77FF77":"#FF7777",style:{position:"absolute",bottom:"16px",right:"16px"}})]})]}):""]})}})}function y(e){let{code:n,setCode:i,language:s}=e;const{colorMode:o}=(0,t.G)(),[l,h]=a.useState(!1);return(0,a.useEffect)((()=>h(!0)),[]),(0,j.jsx)(j.Fragment,{children:(0,j.jsx)(r.f4,{Prism:globalThis.Prism,theme:l&&("dark"===o?d():p()),code:n,language:s,children:e=>{let{tokens:t,getLineProps:s,getTokenProps:r}=e,a=t.map(((e,n)=>(0,j.jsx)("div",{...s({line:e}),children:e.map(((e,n)=>(0,j.jsx)("span",{...r({token:e})},n)))},n)));return i?(0,j.jsx)(c(),{value:n,onValueChange:e=>i(e),highlight:()=>a,padding:0}):a}})})}},5871:e=>{e.exports={plain:{color:"#F8F8F2",backgroundColor:"#282A36",fontWeight:"bold"},styles:[{types:["keyword"],style:{color:"rgb(189, 147, 249)"}},{types:["listop","class-name","quotes"],style:{color:"rgb(80, 250, 123)"}},{types:["builtin"],style:{color:"rgb(5, 227, 223)"}},{types:["number","hexadecimal","string","boolean"],style:{color:"rgb(255, 184, 108)",fontWeight:"normal"}},{types:["punctuation","symbol"],style:{color:"rgb(248, 248, 242)"}},{types:["variable"],style:{fontStyle:"italic"}},{types:["comment"],style:{color:"rgb(98, 114, 164)",fontWeight:"normal"}},{types:["function","car"],style:{color:"rgb(241, 250, 140)"}}]}},9031:e=>{e.exports={plain:{color:"#383a42",backgroundColor:"#fafafa",fontWeight:"bold"},styles:[{types:["keyword"],style:{color:"#990096"}},{types:["listop","class-name","quotes"],style:{color:"#006100"}},{types:["builtin"],style:{color:"#127EAF"}},{types:["number","hexadecimal","string","boolean"],style:{color:"#B35C00",fontWeight:"normal"}},{types:["punctuation","symbol"],style:{color:"#383a42"}},{types:["variable"],style:{fontStyle:"italic"}},{types:["comment"],style:{color:"#73737D",fontWeight:"normal"}},{types:["function","car"],style:{color:"#0045DB"}}]}}}]);