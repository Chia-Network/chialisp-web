"use strict";(self.webpackChunkchialisp_web=self.webpackChunkchialisp_web||[]).push([[8825],{3905:function(e,t,a){a.d(t,{Zo:function(){return u},kt:function(){return m}});var n=a(7294);function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function r(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,i=function(e,t){if(null==e)return{};var a,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}var s=n.createContext({}),h=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):r(r({},t),e)),a},u=function(e){var t=h(e.components);return n.createElement(s.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},p=n.forwardRef((function(e,t){var a=e.components,i=e.mdxType,o=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),p=h(a),m=i,d=p["".concat(s,".").concat(m)]||p[m]||c[m]||o;return a?n.createElement(d,r(r({ref:t},u),{},{components:a})):n.createElement(d,r({ref:t},u))}));function m(e,t){var a=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=a.length,r=new Array(o);r[0]=p;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:i,r[1]=l;for(var h=2;h<o;h++)r[h]=a[h];return n.createElement.apply(null,r)}return n.createElement.apply(null,a)}p.displayName="MDXCreateElement"},7903:function(e,t,a){a.r(t),a.d(t,{frontMatter:function(){return l},contentTitle:function(){return s},metadata:function(){return h},toc:function(){return u},default:function(){return p}});var n=a(7462),i=a(3366),o=(a(7294),a(3905)),r=["components"],l={id:"cats",title:"Chia Asset Tokens (CATs)"},s=void 0,h={unversionedId:"puzzles/cats",id:"puzzles/cats",isDocsHomePage:!1,title:"Chia Asset Tokens (CATs)",description:"Contents:",source:"@site/docs/puzzles/cats.md",sourceDirName:"puzzles",slug:"/puzzles/cats",permalink:"/docs/puzzles/cats",editUrl:"https://github.com/Chia-Network/chialisp-web/edit/main/docs/puzzles/cats.md",version:"current",frontMatter:{id:"cats",title:"Chia Asset Tokens (CATs)"},sidebar:"someSidebar",previous:{title:"Pooling",permalink:"/docs/puzzles/pooling"},next:{title:"Offers",permalink:"/docs/puzzles/offers"}},u=[{value:"Introduction to CATs",id:"introduction-to-cats",children:[]},{value:"Design choices",id:"design-choices",children:[]},{value:"Spend Accounting",id:"spend-accounting",children:[]},{value:"Extra Delta",id:"extra-delta",children:[]},{value:"The Token and Asset Issuance Limiter (TAIL) Program",id:"the-token-and-asset-issuance-limiter-tail-program",children:[]},{value:"The limits of a TAIL&#39;s power",id:"the-limits-of-a-tails-power",children:[]},{value:"TAIL Examples",id:"tail-examples",children:[]},{value:"CAT denominations, value, and retirement rules",id:"cat-denominations-value-and-retirement-rules",children:[]},{value:"Conclusion",id:"conclusion",children:[]}],c={toc:u};function p(e){var t=e.components,a=(0,i.Z)(e,r);return(0,o.kt)("wrapper",(0,n.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"Contents:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#introduction-to-cats"},"Introduction to CATs")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#design-choices"},"Design choices")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#spend-accounting"},"Spend Accounting")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#extra-delta"},"Extra Delta")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#the-token-and-asset-issuance-limiter-tail-program"},"The Token and Asset Issuance Limiter (TAIL) Program")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#the-limits-of-a-tails-power"},"The limits of a TAIL's power")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#tail-examples"},"TAIL Examples")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#cat-denominations-value-and-retirement-rules"},"CAT denominations, value, and retirement rules")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"#conclusion"},"Conclusion"))),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"introduction-to-cats"},"Introduction to CATs"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Chia Asset Tokens (CATs)")," are fungible tokens that are issued from XCH.\nThe CAT1 Standard is the first (and so far only) CAT Standard. It was finalized in January 2022. More information on the naming conventions used in this document can be found ",(0,o.kt)("a",{parentName:"p",href:"https://www.chia.net/2021/09/23/chia-token-standard-naming.en.html",title:"Blog entry explaining CAT1 naming conventions"},"here"),"."),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},(0,o.kt)("strong",{parentName:"p"},"Reminder:")),(0,o.kt)("blockquote",{parentName:"blockquote"},(0,o.kt)("p",{parentName:"blockquote"},(0,o.kt)("strong",{parentName:"p"},"Fungible tokens")," can be split apart, or merged together.\nThey can also be substituted for a token of equal value.\nSome common examples include gold, oil, and dollars.")),(0,o.kt)("blockquote",{parentName:"blockquote"},(0,o.kt)("p",{parentName:"blockquote"},(0,o.kt)("strong",{parentName:"p"},"Non-fungible tokens"),", on the other hand, are indivisible and cannot be merged.\nThey are unique, so they cannot be substituted.\nSome common examples include cars, baseball cards, and cloakroom tickets."))),(0,o.kt)("p",null,'CATs have the property of being "marked" in a way that makes them unusable as regular XCH. However, it is usually possible to "melt" CATs back into XCH later. CATs are often used as credits, or tokens - kind of like casino chips.'),(0,o.kt)("p",null,"The chialisp code that ",(0,o.kt)("strong",{parentName:"p"},"all CATs")," share is ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/Chia-Network/chia-blockchain/blob/main/chia/wallet/puzzles/cat.clvm",title:"cat.clvm - the source code that all CATs share"},"here"),". Without following this puzzle format, wallets will not be able to recognize a token as a CAT."),(0,o.kt)("p",null,"The entire purpose of the code linked above is to ensure that the supply of a specific CAT never changes unless a specific set of \u201crules of issuance\u201d is followed. Each CAT has its own unique rules of issuance, ",(0,o.kt)("strong",{parentName:"p"},"which is the only distinction between different types of CATs"),". These issuance rules take the form of an arbitrary Chialisp program that follows a specific structure.  We call that program the ",(0,o.kt)("strong",{parentName:"p"},"Token and Asset Issuance Limitations (TAIL)"),"."),(0,o.kt)("p",null,"The CAT layer is an ",(0,o.kt)("a",{parentName:"p",href:"https://chialisp.com/docs/common_functions#outer-and-inner-puzzles",title:"Chialisp documentation for how to create outer and inner puzzles"},"outer puzzle"),", which contains two curried parameters:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"An inner puzzle, which controls the CAT's ownership."),(0,o.kt)("li",{parentName:"ol"},"The puzzlehash of a TAIL, which defines three aspects of a CAT:",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"The CAT's type. (Two CATs with the same TAIL are of the same type, even if they contain different inner puzzles.)"),(0,o.kt)("li",{parentName:"ul"},"The CAT's issuance rules."),(0,o.kt)("li",{parentName:"ul"},"The CAT's melting rules.")))),(0,o.kt)("p",null,"Some examples of issuance requirements that different TAILs could accommodate include:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Stablecoins - The creator will want to mint new tokens as they gain funds to back them."),(0,o.kt)("li",{parentName:"ul"},"Limited supply tokens - The creator will want to run a single issuance, with the guarantee that no more tokens of the same type can ever be minted."),(0,o.kt)("li",{parentName:"ul"},"Asset redemption tokens - The creator will want to allow the CAT's owners to melt the tokens into standard XCH, as long as they follow certain rules.")),(0,o.kt)("p",null,"In all of these cases, the TAIL program is run when a coin is spent to check if the issuance is valid."),(0,o.kt)("p",null,"We will cover the TAIL program in more detail later, but first let's cover what the CAT layer does."),(0,o.kt)("h2",{id:"design-choices"},"Design choices"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"When a CAT is spent, any coins created automatically become CATs with the same TAIL")),(0,o.kt)("p",{parentName:"li"},"  When an inner puzzle returns a CREATE_COIN condition, the CAT layer will recognize this and change the condition to a CAT of the same type as itself."),(0,o.kt)("p",{parentName:"li"},"  For example, let's say the inner puzzle returns the following CREATE_COIN condition:\n",(0,o.kt)("inlineCode",{parentName:"p"},"(51 0xcafef00d amount)")),(0,o.kt)("p",{parentName:"li"},"  In this case, the CAT layer will calculate a puzzlehash for a CAT with the same TAIL as itself, and an inner puzzle of ",(0,o.kt)("inlineCode",{parentName:"p"},"0xcafef00d"),".")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"If a CAT does not use a TAIL, then a SpendBundle of CATs must not gain or lose any value")),(0,o.kt)("p",{parentName:"li"},"  In order to ensure that a CAT cannot be minted or retired without official authentication, all CATs that do not use a TAIL program ",(0,o.kt)("strong",{parentName:"p"},"MUST")," be a part of a spendbundle that outputs the same amount of value as its input.\nWe use a group accounting trick to guarantee this, which we will cover in more detail below.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"If a CAT is not approved by a TAIL program, then its parent must be a CAT of the same type")),(0,o.kt)("p",{parentName:"li"},"Another way we prevent CATs from being minted in unapproved methods is by ensuring that the tokens have a valid lineage. Commonly this is done by asserting that the CAT's parent was also a CAT of the same type."),(0,o.kt)("p",{parentName:"li"},"This is accomplished by passing in the coin's information, returning an ",(0,o.kt)("inlineCode",{parentName:"p"},"ASSERT_MY_ID")," condition, and then passing in the parent information.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"CATs enforce prefixes for Coin Announcements")),(0,o.kt)("p",{parentName:"li"},"In order to ensure that the CATs can communicate with each other without interference from an inner puzzle, they must prepend an appropriate coin announcement with the following rules:"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"If the announcement comes from the CAT layer, it is prepended with ",(0,o.kt)("inlineCode",{parentName:"li"},"0xcb"),"."),(0,o.kt)("li",{parentName:"ul"},"If the announcement comes from the inner puzzle, it is prepended with ",(0,o.kt)("inlineCode",{parentName:"li"},"0xca"),"."))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"CATs pass a list of pre-calculated Truths to their TAIL")),(0,o.kt)("p",{parentName:"li"},"Many TAILs require information that has already been calculated in the CAT layer, so we bundle it together as a pre-validated collection of ",(0,o.kt)("strong",{parentName:"p"},"Truths"),". We then pass these Truths into the TAIL as the first non-curried parameter in the solution."),(0,o.kt)("p",{parentName:"li"},"The Truths are:"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"My ID - The ID of the coin"),(0,o.kt)("li",{parentName:"ul"},"My Parent's ID - The ID of the coin's parent"),(0,o.kt)("li",{parentName:"ul"},"My Full Puzzle Hash - The puzzlehash contained inside the coin"),(0,o.kt)("li",{parentName:"ul"},"My Amount - The value of the coin"),(0,o.kt)("li",{parentName:"ul"},"My Inner Puzzle Hash - The puzzlehash of the inner puzzle inside this coin's CAT layer"),(0,o.kt)("li",{parentName:"ul"},"My Lineage Proof - (optional) Proof that the CAT's parent is of the same type as the CAT"),(0,o.kt)("li",{parentName:"ul"},"My TAIL Solution - (optional) A list of parameters passed into the TAIL program"),(0,o.kt)("li",{parentName:"ul"},"My Coin Info"),(0,o.kt)("li",{parentName:"ul"},"CAT Mod Hash - The hash of the CAT before anything is curried"),(0,o.kt)("li",{parentName:"ul"},"CAT Mod Hash Hash - The hash of the CAT Mod Hash"),(0,o.kt)("li",{parentName:"ul"},"CAT TAIL Program Hash - The hash of the TAIL program that was curried into the CAT")))),(0,o.kt)("h2",{id:"spend-accounting"},"Spend Accounting"),(0,o.kt)("p",null,"Each CAT coin has a truthful calculation of the difference between its amount and its output amount, called its ",(0,o.kt)("strong",{parentName:"p"},"Delta"),"."),(0,o.kt)("p",null,"The CAT coins also are given the sum of every other coin's Deltas, which must be zero. In order to enforce this zero-Delta rule, each CAT coin is assigned a Next and Previous neighbor, which ultimately forms a ring."),(0,o.kt)("p",null,"The coins use Coin Announcements to communicate with their neighbors. For our use case, the announcements must contain two pieces of information:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"The ID of the coin that created this coin. This is already implicitly contained in the Coin Announcement."),(0,o.kt)("li",{parentName:"ul"},"The intended recipient's coin ID. The announcement's message must contain this information in order to prevent attacks where coins can receive messages that weren't intended for them.")),(0,o.kt)("p",null,"To form the ring, every coin outputs the following conditions:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"(\n  (CREATE_COIN_ANNOUNCEMENT previous_coin_ID + sum_of_deltas_before_me)\n  (ASSERT_COIN_ANNOUNCEMENT sha256(next_coin_id + my_coin_id + sum_of_deltas_including_me))\n)\n")),(0,o.kt)("p",null,"Where ",(0,o.kt)("inlineCode",{parentName:"p"},"+")," represents concatenation of bytes, and announcement assertions take the hash of the announcement creator's ID and message."),(0,o.kt)("p",null,"In order to create the ",(0,o.kt)("inlineCode",{parentName:"p"},"next_coin_id"),", we wrap the next coin's inner puzzle with the current coin's CAT information. This guarantees that the next_coin_id is a CAT of the same type as the current coin."),(0,o.kt)("p",null,"Because both coins follow the same CAT module code, they must comply with the same set of truths. This, in turn, guarantees that the whole ring is telling the truth. As long as the ring is connected, the total Delta must be zero."),(0,o.kt)("h2",{id:"extra-delta"},"Extra Delta"),(0,o.kt)("p",null,"There are two exceptions to the aforementioned zero-Delta rule:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Minting coins (creating CATs from XCH)"),(0,o.kt)("li",{parentName:"ul"},"Retiring coins (melting CATs to their original XCH form)")),(0,o.kt)("p",null,"To account for these cases, the TAIL program may approve a misreporting of a CAT coin's Delta by a specific amount, called the ",(0,o.kt)("strong",{parentName:"p"},"Extra Delta"),". This is one of the parameters passed to the TAIL program."),(0,o.kt)("p",null,"There are a few rules to ensure that extra coins are not minted or retired:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"If the Extra Delta is anything other than ",(0,o.kt)("inlineCode",{parentName:"li"},"0"),", the TAIL program is forced to run. It must evaluate whether to permit the Extra Delta, or fail with an ",(0,o.kt)("inlineCode",{parentName:"li"},"(x)")," call."),(0,o.kt)("li",{parentName:"ul"},"If the Extra Delta value in the solution does not cause the TAIL program to fail, then it is automatically added to the reported Delta, which is used in the announcement ring."),(0,o.kt)("li",{parentName:"ul"},"If the TAIL program is not revealed and the Extra Delta is not ",(0,o.kt)("inlineCode",{parentName:"li"},"0"),", then the puzzle will fail.")),(0,o.kt)("h2",{id:"the-token-and-asset-issuance-limiter-tail-program"},"The Token and Asset Issuance Limiter (TAIL) Program"),(0,o.kt)("p",null,"The TAIL program is powerful and flexible. It has control over, and access to, many things. This gives a programmer a lot of control, but also a great deal of responsibility."),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},(0,o.kt)("strong",{parentName:"p"},"Warning"),": If the TAIL is not programmed correctly,\nthen tokens may be minted by attackers,\nrendering the asset worthless.")),(0,o.kt)("p",null,"A TAIL should follow all of the conventional rules of security that any Chialisp program responsible for locking up money should follow."),(0,o.kt)("p",null,"Several parameters must be passed to a TAIL's solution:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Truths - These are bundled together, as explained above"),(0,o.kt)("li",{parentName:"ul"},"parent_is_cat - A flag indicating whether the parent has been validated as a CAT of the same type as this CAT"),(0,o.kt)("li",{parentName:"ul"},"lineage_proof - (optional) Proof that the parent is a CAT of the same type as this CAT"),(0,o.kt)("li",{parentName:"ul"},"delta - The Extra Delta value, as explained above"),(0,o.kt)("li",{parentName:"ul"},"inner_conditions - The conditions returned by the inner puzzle (see below)"),(0,o.kt)("li",{parentName:"ul"},"tail_solution - (optional) A list of opaque parameters")),(0,o.kt)("p",null,"Although the TAIL is powerful, it is ",(0,o.kt)("strong",{parentName:"p"},"not necessarily"),' run every time the coin is spent. The TAIL is run if a "magic" condition is created in the inner puzzle. This "magic" condition is required to prevent people who can spend the TAIL from intercepting the spend and changing it against the spender\'s will. The "magic" condition that triggers the TAIL to be run must look like this:'),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"(51 <doesn't matter> -113 <TAIL puzzle> <TAIL solution>)"),", where:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"51")," is the condition code for CREATE_COIN."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"<doesn't matter>")," can be anything, for example 0. (This would normally be a puzzlehash. It is ignored in this case.)"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"-113"),' is the "magic" amount, which signals to cat.clvm that the TAIL must be run. We chose to make this number negative because negative coins are invalid, so this would never be confused for a valid coin spend. Otherwise, there was no special reason for using -113.')),(0,o.kt)("p",null,"The TAIL should check diligently for the following things:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Is the Extra Delta minting or retiring any coins, and if so, do I approve?"),(0,o.kt)("li",{parentName:"ul"},"If this coin's parent is not a CAT of the same type as me, do I approve?")),(0,o.kt)("h2",{id:"the-limits-of-a-tails-power"},"The limits of a TAIL's power"),(0,o.kt)("p",null,"In Ethereum, a token's issuer might have the ability to freeze or confiscate funds without the owner's permission. This is not possible in Chia. Let's explore why."),(0,o.kt)("p",null,"In Chia, an issuer creates a TAIL, which lives inside all CATs of the same type, including those that have already been distributed. However, the issuer does not have the power to spend coins they do not own. A TAIL can only run as the last step in a CAT's spend, and the owner of the CAT (and not the issuer) is responsible for providing its solution. This means that only the owner can run the TAIL. Therefore, the CAT's owner is the only one with the ability to complete the spend."),(0,o.kt)("p",null,"This decision adds some decentralization for users. It also adds some complexity. The importance of creating a well-constructed TAIL cannot be emphasized enough. Once you have distributed a CAT, it is no longer possible to change the TAIL across the entire token supply. The TAIL is locked into the same set of rules forever. To change the TAIL would be tantamount to replacing physical cash in circulation. You would have to offer an exchange for new tokens and eventually deprecate the old token, even if some people still carry it."),(0,o.kt)("p",null,"It also means that if the set of rules is compromised, people may be able to mint or retire CATs maliciously. There\u2019s no easy way to \u201cpatch\u201d the TAIL, other than through the process above, which is obviously best avoided."),(0,o.kt)("h2",{id:"tail-examples"},"TAIL Examples"),(0,o.kt)("p",null,"The CAT1 standard currently includes three example TAILs, though many more are possible."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("a",{parentName:"p",href:"https://github.com/Chia-Network/chia-blockchain/blob/main/chia/wallet/puzzles/genesis-by-coin-id-with-0.clvm",title:"Chialisp code for the One-Time Minting TAIL"},"One-Time Minting")),(0,o.kt)("p",{parentName:"li"},"The default way in which we currently issue CATs is with a TAIL that only allows coin creation from a specific coin ID. In Chia, coins can only be spent once, so this results in a one-time minting of a CAT. After the issuance, there will never be any more or less of the CAT, and no one will be able to run the same TAIL ever again.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("a",{parentName:"p",href:"https://github.com/Chia-Network/chia-blockchain/blob/main/chia/wallet/puzzles/everything_with_signature.clvm",title:"Chialisp code for the Everything With Signature TAIL"},"Everything With Signature")),(0,o.kt)("p",{parentName:"li"},"The polar opposite of the TAIL above is the ability of the creator to do whatever they want, as long as they provide a signature from their public key. This key is curried into the TAIL, which returns a single AGG_SIG_ME condition asking for a matching signature. If the creator can provide that signature, then the spend passes and any supply rules that were violated are ignored."),(0,o.kt)("p",{parentName:"li"},"Keep in mind that AGG_SIG_ME only allows the signature to work on a single coin. Therefore, the creator cannot release a signature for everyone to use; instead the creator must personally sign every TAIL execution.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("a",{parentName:"p",href:"https://github.com/Chia-Network/chia-blockchain/blob/main/chia/wallet/puzzles/delegated_genesis_checker.clvm",title:"Chialisp code for the Delegated TAIL"},"Delegated TAIL")),(0,o.kt)("p",{parentName:"li"},'This is the best balance of security and flexibility that we currently have. The Delegated TAIL is similar to the "Everything With Signature" example, except instead of requiring a signature from a specific coin, it requires a signature from a specific puzzlehash. When the puzzlehash has been signed, the creator may run that puzzle in place of the TAIL.'),(0,o.kt)("p",{parentName:"li"},"This TAIL allows the creator to create new TAILs that they can use with the CAT, even if those TAILs didn't exist during the initial issuance! For example, the creator could create:"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"A single minting"),(0,o.kt)("li",{parentName:"ul"},"A DID to mint new coins"),(0,o.kt)("li",{parentName:"ul"},"Anything else they want!")),(0,o.kt)("p",{parentName:"li"},"Note that we use AGG_SIG_UNSAFE in order to make this signature work for all coins. The creator can publish a valid signature, allowing any owner of the CAT to run the TAIL on their own. One scenario where this is useful is in redemption schemes -- you want to allow people to melt their CATs into XCH as long as they follow certain rules when they do so."),(0,o.kt)("p",{parentName:"li"},"There is another consideration to make when you are signing new Delegated TAILs. Once you sign it and publish the signature, it is out there forever. Be careful what permissions you grant because you can never take them back."))),(0,o.kt)("h2",{id:"cat-denominations-value-and-retirement-rules"},"CAT denominations, value, and retirement rules"),(0,o.kt)("p",null,"Some design decisions regarding the granularity and denomination of CATs versus XCH:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Most Chia wallets choose to display their value in XCH. However, this is a purely cosmetic choice because Chia's blockchain only knows about mojos. One XCH is equal to one trillion (1,000,000,000,000) mojos."),(0,o.kt)("li",{parentName:"ul"},"In a similar vein, Chia Network has made the design decision to map 1 CAT to 1000 XCH mojos. This ratio will be the same for all CATs."),(0,o.kt)("li",{parentName:"ul"},"Theoretically, it would be possible to set the CAT:mojo ratio to something other than 1:1000 for a specific CAT, but we strongly recommend against doing this. The official Chia wallet will not support CATs with a ratio other than 1:1000. Additionally, if you created your own wallet with support for different ratios, users of this wallet would almost certainly be confused and accidentally spend too much or too little money, by multiple orders of magnitude. Please don't attempt this."),(0,o.kt)("li",{parentName:"ul"},"The melt value of a single token is 1000 mojos. This remains true regardless of the token's face value or its circulating supply."),(0,o.kt)("li",{parentName:"ul"},"A token's face value and its melt value are not necessarily correlated, let alone matched.")),(0,o.kt)("p",null,"By analogy, on multiple occasions the US Treasury has floated the idea of minting a $1 trillion coin made from platinum. Leaving aside the practical implications of doing this, the magnitude of the difference between this hypothetical coin's face value and melt value would be similar to that of CATs and XCH. The coin would be worth $1 trillion dollars, but if someone melted it and sold the platinum, they'd only receive a minuscule fraction of that amount."),(0,o.kt)("p",null,"On the other end of the spectrum, consider the US penny. Its base metals (97.5% zinc and 2.5% copper) are worth around two cents. So in theory, if you could melt a penny into zinc and copper while minimizing your costs, you could sell these metals for a sizable profit."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"The value of XCH and CATs")),(0,o.kt)("p",null,"The face value of both XCH and CATs is market-driven -- the coins are worth whatever someone is willing to pay for them."),(0,o.kt)("p",null,"If a CAT achieves a certain level of financial success, its face value will be greater than its melt value, just like the $1 trillion coin would be worth more than the metal it was minted from. For example:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"A meme token could trade for one-millionth of an XCH, or 1,000,000 mojos. The token is worth very little money, but it's still 1000 times more valuable than its melt value of 1000 mojos."),(0,o.kt)("li",{parentName:"ul"},"A dollar-backed stablecoin will have a face value of $1. Its melt value will be 1000 mojos."),(0,o.kt)("li",{parentName:"ul"},"A highly successful token could even sell for more than one XCH -- there are no rules preventing this from happening. Its melt value would still be 1000 mojos.")),(0,o.kt)("p",null,"One real-world analogy for these three cases is that you could start with a piece of metal and mint a coin worth a fraction of a cent, or $1, or $10,000, or really any other value. But no matter the face value, the melt value would always remain the same."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"CAT retirement use cases and rules")),(0,o.kt)("p",null,"It's important to keep in mind that a CAT's TAIL (and nothing else) decides the rules for retirement, ",(0,o.kt)("em",{parentName:"p"},"if")," it allows retirement at all. For example, our single-mint TAIL only works with a specific coin, so it does not allow retirement. CATs that use this TAIL can never be melted, no matter how small their face value."),(0,o.kt)("p",null,"Our delegated TAIL leaves it entirely up to the CAT's creator whether -- and how -- retirement can happen."),(0,o.kt)("p",null,"Beyond our pre-packaged examples, TAILs with a wide range of functionality are also possible. To illustrate just some of this functionality, let's consider four potential reasons for retirement, along with who gets to retire the tokens:"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"1. Removal from circulation (must be the creator AND owner)")),(0,o.kt)("p",null,"  For certain categories of CATs (for example, stablecoins and redemption tokens), retirement will be allowed, but only by the creator, who also must own the tokens. In the case of a stablecoin, the creator may need to remove some tokens from circulation if backing funds are reduced. For redemption tokens, the owner may exchange a token with the creator for something of value. The token no longer has any face value, so its creator will remove it from circulation."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"2. Value exchange (must be the owner)")),(0,o.kt)("p",null,"  Some CATs might allow their owners to melt tokens in order to gain something else of value, for example NFTs or other CATs. In fact, an entire marketplace could emerge from this concept. Some possible examples:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},'The creator of a set of NFTs also creates a small issuance of "golden tickets" that can be used to pick out any individual NFT before the set is made publicly available.'),(0,o.kt)("li",{parentName:"ul"},"A celebrity mints some tokens that can be exchanged for something of non-monetary value, such as a meeting with said celebrity."),(0,o.kt)("li",{parentName:"ul"},'The holder of a CAT must submit a "proof of melt" in order to enter a contest.')),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"3. Ephemeral tokens (must be the creator OR a preset algorithm)")),(0,o.kt)("p",null,"  A CAT could be created as a limited-time offer or as a game of Musical Chairs. In these cases, tokens would be melted ",(0,o.kt)("em",{parentName:"p"},"against the owner's will"),". This could be done either at random or as a deliberate type of slashing. "),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"4. Melt-value retrieval (must be the owner)")),(0,o.kt)("p",null,"  If a CAT is not financially successful, its melt value could exceed its face value, in the same way that the metals that compose a US penny are worth more than one cent. In this case, it might make financial sense for the CAT's owner to retire a token by melting it into 1000 XCH mojos. Because of the low melt value of tokens, this motivation for melting will likely be rare."),(0,o.kt)("p",null,"In each of these examples, the rules of retirement for a specific CAT are clearly spelled out in the TAIL. If a TAIL allows for retirement against the owner's will, the owner will be able to ascertain this information before acquiring the token."),(0,o.kt)("h2",{id:"conclusion"},"Conclusion"),(0,o.kt)("p",null,"The CAT1 standard is an exciting addition to Chia's ecosystem. It allows near-limitless functionality for issuing fungible tokens. We're excited to see what kind of creative ideas the Chia community comes up with!"))}p.isMDXComponent=!0}}]);