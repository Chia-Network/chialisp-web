<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-attacks-and-countermeasures" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Attacks and Countermeasures | Chialisp</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://chialisp.com/attacks-and-countermeasures/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Attacks and Countermeasures | Chialisp"><meta data-rh="true" name="description" content="Replay Attacks"><meta data-rh="true" property="og:description" content="Replay Attacks"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://chialisp.com/attacks-and-countermeasures/"><link data-rh="true" rel="alternate" href="https://chialisp.com/attacks-and-countermeasures/" hreflang="en"><link data-rh="true" rel="alternate" href="https://chialisp.com/attacks-and-countermeasures/" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Attacks and Countermeasures","item":"https://chialisp.com/attacks-and-countermeasures"}]}</script><script src="/js/matomo.js" async defer="defer"></script><link rel="stylesheet" href="/assets/css/styles.bb770339.css">
<script src="/assets/js/runtime~main.8df72f8a.js" defer="defer"></script>
<script src="/assets/js/main.aeb02a9d.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.svg"><link rel="preload" as="image" href="/img/full_logo_white.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Chialisp Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="Chialisp Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Chialisp</b></a><a href="https://docs.chia.net" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Chia Docs<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><a href="https://docs.chia.net/academy-home/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Chia Academy<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://chia.net" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Chia.net<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><a href="https://github.com/Chia-Network/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input searchInput_YFbd" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/"><span title="Introduction" class="linkLabel_WmDU">Introduction</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/chialisp-primer/"><span title="Chialisp Primer" class="categoryLinkLabel_W154">Chialisp Primer</span></a><button aria-label="Expand sidebar category &#x27;Chialisp Primer&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/chialisp-concepts/"><span title="Chialisp Concepts" class="categoryLinkLabel_W154">Chialisp Concepts</span></a><button aria-label="Expand sidebar category &#x27;Chialisp Concepts&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/commands/"><span title="Commands" class="linkLabel_WmDU">Commands</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/syntax/"><span title="Syntax" class="linkLabel_WmDU">Syntax</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/modern-chialisp/"><span title="Modern Chialisp" class="linkLabel_WmDU">Modern Chialisp</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/operators/"><span title="Operators" class="linkLabel_WmDU">Operators</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/examples/"><span title="Examples" class="linkLabel_WmDU">Examples</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/costs/"><span title="Costs" class="linkLabel_WmDU">Costs</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/conditions/"><span title="Conditions" class="linkLabel_WmDU">Conditions</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/optimization/"><span title="Optimization" class="linkLabel_WmDU">Optimization</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/common_issues/"><span title="Common Issues" class="linkLabel_WmDU">Common Issues</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/attacks-and-countermeasures/"><span title="Attacks and Countermeasures" class="linkLabel_WmDU">Attacks and Countermeasures</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/debugging/"><span title="Debugging" class="linkLabel_WmDU">Debugging</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/standard-transactions/"><span title="Primitives" class="categoryLinkLabel_W154">Primitives</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/clvm/"><span title="CLVM" class="linkLabel_WmDU">CLVM</span></a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Attacks and Countermeasures</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Attacks and Countermeasures</h1></header><h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="replay-attacks">Replay Attacks<a href="#replay-attacks" class="hash-link" aria-label="Direct link to Replay Attacks" title="Direct link to Replay Attacks" translate="no">​</a></h2>
<p>Fundamentally, the concern with a replay attack on a Chia transaction is that you could use the same signature as a previous coin spend to spend a new coin that it wasn&#x27;t intended for. For example, if the <a class="" href="/standard-transactions/">standard transaction</a> were to use <a class="" href="/conditions/#agg-sig-puzzle"><code>AGG_SIG_PUZZLE</code></a> instead of <a class="" href="/conditions/#agg-sig-me"><code>AGG_SIG_ME</code></a>, you would be able to use a signature to spend multiple coins with the same puzzle hash.</p>
<p>However, what a replay attack doesn&#x27;t allow you to do is change the delegated puzzle. The signature is verified against a message (the tree hash of the delegated puzzle) concatenated with the coin info (i.e. a coin id or puzzle hash) and often the genesis challenge. So, if you used <a class="" href="/conditions/#agg-sig-puzzle"><code>AGG_SIG_PUZZLE</code></a>, you&#x27;d be able to spend multiple coins with the same puzzle hash, but they would all have to output the same conditions.</p>
<p>If the conditions of a spend aren&#x27;t met, it will be rejected by consensus. This means that you could use other means to prevent replay attacks than simply requiring a specific coin id. For example, if you were to have an <a class="" href="/conditions/#agg-sig-puzzle"><code>AGG_SIG_PUZZLE</code></a> but the conditions included a <a class="" href="/conditions/#66-send_message"><code>SEND_MESSAGE</code></a> being sent to a specific coin id, that other coin would have to be spent for this message to be received. And since messages are 1:1, there&#x27;s no way to spend multiple coins with this signature even if they were included in the same block.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="vault-spends">Vault Spends<a href="#vault-spends" class="hash-link" aria-label="Direct link to Vault Spends" title="Direct link to Vault Spends" translate="no">​</a></h3>
<p>When you spend a vault, you&#x27;re typically doing one of two things:</p>
<ol>
<li class=""><strong>Changing the custody configuration</strong> (i.e. modifying the custody signers or recovery signers)</li>
<li class=""><strong>Spending coins that are &quot;owned by&quot; the vault</strong> (p2 coins)</li>
</ol>
<p>When you change the custody configuration, the puzzle hash of the vault inherently changes. This means that the signature that was used to perform the rekey is no longer valid to spend the coin, since it committed to a specific puzzle hash.</p>
<p>When you spend other p2 coins (including fee coins or other XCH, <a class="" href="/cats/">CATs</a>, <a class="" href="/nfts/">NFTs</a>, etc) that are owned by the vault, the vault&#x27;s delegated puzzle will include a <a class="" href="/conditions/#66-send_message"><code>SEND_MESSAGE</code></a> condition send to each coin id. Similarly to the <a class="" href="/conditions/#agg-sig-puzzle"><code>AGG_SIG_PUZZLE</code></a> example, this message&#x27;s presence prevents it from being replayed since the message will only be valid for a single spend.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="fast-forward">Fast Forward<a href="#fast-forward" class="hash-link" aria-label="Direct link to Fast Forward" title="Direct link to Fast Forward" translate="no">​</a></h2>
<p>The reason to use <a class="" href="/conditions/#agg-sig-puzzle"><code>AGG_SIG_PUZZLE</code></a> or <a class="" href="/conditions/#assert-my-puzzlehash"><code>ASSERT_MY_PUZZLE_HASH</code></a> instead of <a class="" href="/conditions/#agg-sig-me"><code>AGG_SIG_ME</code></a> or <a class="" href="/conditions/#assert-my-coin-id"><code>ASSERT_MY_COIN_ID</code></a> in a vault spend is that you don&#x27;t want to restrict a spend to a specific coin id.</p>
<p>The most common scenarios are:</p>
<ul>
<li class="">You have a transaction pending in the mempool already but want to make another</li>
<li class="">You want to create multiple <a class="" href="/offers/">offer files</a> that spend the vault to spend different p2 coins</li>
</ul>
<p>There&#x27;s a feature called <strong>singleton fast forward</strong> (used by <a class="" href="/singletons/">singletons</a>), which allows the mempool to &quot;rebase&quot; transactions on top of each other if they spend the same coin. This is only possible if certain conditions are met, such as not relying on the coin id, not changing the puzzle hash or amount, etc.</p>
<p>So the idea is that you can assert the puzzle hash, but not the coin id, and instead use messages to specific coins to prevent replay attacks. This way multiple concurrent transactions can co-exist, including outstanding offer files, and they won&#x27;t conflict in the mempool.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="edge-case">Edge Case<a href="#edge-case" class="hash-link" aria-label="Direct link to Edge Case" title="Direct link to Edge Case" translate="no">​</a></h2>
<p>Almost all vault transactions, including rekeys and p2 coin spends, are safe from replay attacks. However, there is one rare scenario where a replay attack is possible and steps in the wallet must be taken to prevent this from happening. Note that this type of transaction (rekeying without recovery) is not currently possible in Cloud Wallet, so this attack is not possible at this time, and can be mitigated properly when it is supported later.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="the-attack-scenario">The Attack Scenario<a href="#the-attack-scenario" class="hash-link" aria-label="Direct link to The Attack Scenario" title="Direct link to The Attack Scenario" translate="no">​</a></h3>
<p>If you start with custody config A, and complete a rekey to custody config B, you&#x27;ve changed the vault&#x27;s puzzle hash. As described previously, the vault can&#x27;t be spent using the old signature since the puzzle hash won&#x27;t match. Additionally, if you included a fee spend, the message would also prevent this from happening.</p>
<p>However, if the vault is ever rekeyed back into custody config A (i.e. it now has the old puzzle hash again), and there was no p2 coin spend to pay for fees in the original transaction (thus no message was sent), then it&#x27;s possible for an attacker to spend the vault using the old signature. This would give any unauthorized third party the ability to re-perform the same rekey into custody config B.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="prevention-methods">Prevention Methods<a href="#prevention-methods" class="hash-link" aria-label="Direct link to Prevention Methods" title="Direct link to Prevention Methods" translate="no">​</a></h3>
<p>The way to prevent this is to either:</p>
<ol>
<li class=""><strong>Require a p2 coin spend when performing a rekey</strong> - This ensures a message is sent, preventing replay</li>
<li class=""><strong>Increment the nonce when you go back to an old custody config</strong> - This prevents the puzzle hash from reverting to its original state</li>
<li class=""><strong>Include other invalidating conditions</strong> - Such as <a class="" href="/conditions/#assert-before-seconds-absolute"><code>ASSERT_BEFORE_SECONDS_ABSOLUTE</code></a> (which would make the signature &quot;expire&quot; after some time has passed)</li>
<li class=""><strong>Include an <a class="" href="/conditions/#assert-my-coin-id"><code>ASSERT_MY_COIN_ID</code></a> condition</strong> - Using the current coin id, since rekeys aren&#x27;t fast forwardable anyways (nor should they be)</li>
</ol>
<p>Perhaps the cleanest approach is to simply include an <a class="" href="/conditions/#assert-my-coin-id"><code>ASSERT_MY_COIN_ID</code></a> condition using the current coin id, since rekeys aren&#x27;t fast forwardable anyways (nor should they be).</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/Chia-Network/chialisp-web/blob/main/docs/attacks-and-countermeasures.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/common_issues/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Common Issues</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/debugging/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Debugging</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#replay-attacks" class="table-of-contents__link toc-highlight">Replay Attacks</a><ul><li><a href="#vault-spends" class="table-of-contents__link toc-highlight">Vault Spends</a></li></ul></li><li><a href="#fast-forward" class="table-of-contents__link toc-highlight">Fast Forward</a></li><li><a href="#edge-case" class="table-of-contents__link toc-highlight">Edge Case</a><ul><li><a href="#the-attack-scenario" class="table-of-contents__link toc-highlight">The Attack Scenario</a></li><li><a href="#prevention-methods" class="table-of-contents__link toc-highlight">Prevention Methods</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/operators/">Operators</a></li><li class="footer__item"><a class="footer__link-item" href="/clvm/">CLVM</a></li><li class="footer__item"><a href="https://docs.chia.net" target="_blank" rel="noopener noreferrer" class="footer__link-item">Chia Docs<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discord.gg/chia" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://twitter.com/chia_project" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.chia.net/blog/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/Chia-Network/clvm" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a class="footerLogoLink_BH7S" href="/"><img src="/img/full_logo_white.svg" alt="Chialisp full logo" class="footer__logo themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/full_logo_white.svg" alt="Chialisp full logo" class="footer__logo themedComponent_mlkZ themedComponent--dark_xIcU"></a></div><div class="footer__copyright">© 2025 Chia Network Inc., Licensed under the <a href="https://github.com/Chia-Network/chialisp-web/blob/main/LICENSE" target="_blank">Apache License, Version 2.0</a> | <a href="https://www.chia.net/terms">Terms</a></div></div></div></footer></div>
</body>
</html>