<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.2">
<title data-react-helmet="true">CLVM Reference Manual | Chialisp</title><meta data-react-helmet="true" property="og:url" content="https://chialisp.com/docs/ref/serialization"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="CLVM Reference Manual | Chialisp"><meta data-react-helmet="true" name="description" content="Serialization"><meta data-react-helmet="true" property="og:description" content="Serialization"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://chialisp.com/docs/ref/serialization"><link data-react-helmet="true" rel="alternate" href="https://chialisp.com/docs/ref/serialization" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://chialisp.com/docs/ref/serialization" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.595463eb.css">
<link rel="preload" href="/assets/js/runtime~main.bb342c07.js" as="script">
<link rel="preload" href="/assets/js/main.c131b766.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="Chialisp Logo" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/img/logo.svg" alt="Chialisp Logo" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><b class="navbar__title">Chialisp</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a><a href="https://chialisp.com/training" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Training<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://chia.net" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Chia.net<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://github.com/Chia-Network/chialisp-web" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></div><div class="navbar__items navbar__items--right"><div class="react-toggle displayOnlyInLargeViewport_cxYs react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_iYfV">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_iYfV">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="navbar__search searchBarContainer_I7kZ"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_Zg7X searchBarLoadingRing_J5Ez"><div></div><div></div><div></div><div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="Chialisp Logo" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/img/logo.svg" alt="Chialisp Logo" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><b class="navbar__title">Chialisp</b></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/">Docs</a></li><li class="menu__list-item"><a href="https://chialisp.com/training" target="_blank" rel="noopener noreferrer" class="menu__link"><span>Training<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="menu__list-item"><a href="https://chia.net" target="_blank" rel="noopener noreferrer" class="menu__link"><span>Chia.net<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="menu__list-item"><a href="https://github.com/Chia-Network/chialisp-web" target="_blank" rel="noopener noreferrer" class="menu__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_lDyR"><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu menu--responsive thin-scrollbar menu_cyFh menuWithAnnouncementBar_+O1J" aria-label="Sidebar navigation"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_iZzd" width="24" height="24" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Chialisp</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/">1 - CLVM Basics</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/coins_spends_and_wallets">2 - Coins, Spends and Wallets</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/deeper_into_clvm">3 - Deeper into CLVM</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/high_level_lang">4 - The High Level Language, Compiler, and Functions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/common_functions">5 - Common Functions in Chialisp</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/standard_transaction">6 - The Standard Transaction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/coin_lifecycle">7 - Lifecycle of a Coin</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/security">8 - Security</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/debugging">9 - Debugging</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/optimization">10 - Optimization</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/glossary">The Great Chia Glossary</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">CLVM</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/ref/clvm">CLVM Reference</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/ref/serialization">Serialization</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Puzzles</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/puzzles/singletons">Singletons</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/puzzles/pooling">Pooling</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/puzzles/cats">Chia Asset Tokens (CATs)</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Tutorials</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tutorials/why_chia_is_great">Why Chia is Great</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tutorials/developing_applications">An Overview of Developing Applications on Chia</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tutorials/tools_and_setup">Tools and Setup</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tutorials/programming_chialisp">Programming in Chialisp</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tutorials/coin_lifecycle_and_testing">Coin Lifecycle and Testing</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tutorials/singletons">Singletons and Ethereum-like Contracts in Chia</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tutorials/high-level-tips-1">High Level Tips - Managing State, Coin Creation, Announcements</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tutorials/high-level-tips-2">High Level Tips - Security, Checking Arguments &amp; Signatures</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tutorials/high-level-tips-3">High Level Tips - Announcements, Oracles</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tutorials/custom_puzzle_lock">Lock a coin with a custom puzzle</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tutorials/coin_spend_rpc">Spend a coin using RPC</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tutorials/structure_of_a_chia_application">Structure of a Chia Application</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tutorials/CAT_Launch_Process_Linux_MacOS">CAT creation tutorial (Linux/MacOS)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tutorials/CAT_Launch_Process_Windows">CAT creation tutorial (Windows)</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">FAQ</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/faq">ChiaLisp and CLVM FAQ</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="markdown"><header><h1 class="h1Heading_dC7a">CLVM Reference Manual</h1></header><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="serialization"></a>Serialization<a class="hash-link" href="#serialization" title="Direct link to heading">#</a></h2><p>The CLVM serialization format closely follows the in-memory representation of the program tree.</p><p>This in turn, closely resembles the text format of a fully compiled CLVM program.</p><p>At the lowest level, there are only two types of Object in the CLVM.</p><ul><li>Pair (also called Cons Pair/Cons Box/Cons Cell) - A pair of two values. Usually, the first value is an atom and contains information, whereas the second value is usually either a pointer to another pair, or a <code>nil</code> atom. Lists are built from these pairs.</li><li>Atom - A value that holds data, which is represented as a byte array with the static length. Empty, zero-length atoms are used to represent <code>nil</code> value.</li></ul><p>Each CLVM Object is represented by a series of one or more bytes. Each byte belongs to the representation of exactly one CLVM Object. That is, no bits in a byte are shared by multiple CLVM objects.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="values"></a>Values<a class="hash-link" href="#values" title="Direct link to heading">#</a></h3><p>Each value in the CLVM is an untyped sequence of bytes. In the running virtual machine, values have a property length, containing the number of bytes. The same concept is preserved in the serialization format. However, values must be distinguished from cons boxes in the byte stream, so an escaping scheme is used. This escaping means that serialized values using more than 7 bits have a different representation than the in memory representation.</p><p>Nil has a single predefined value which is not shared with any user-defined value.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="encoding"></a>Encoding<a class="hash-link" href="#encoding" title="Direct link to heading">#</a></h3><p>Values which can be represented in 7 bits are encoded as a single byte with that value. Larger serialized values are represented as a sequence of bytes that encode the size, and then the value bytes.</p><p>The encoding scheme for the size prefix is as follows:</p><p>The value of the first serialized byte determines the number of size bytes (1 to 6, including the first byte). The size then determines the number of bytes denoting the value (0 to 0x400000000-1 bytes long)</p><p><strong>size</strong> is the length of the byte array containing the value, as an integer.
In the table below, we use <strong>s</strong> to describe the bytes that make up the encoded size value, s[0] being the least significant byte of <strong>size</strong>. The size bytes are encoded MSB first.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#383a42;background-color:#fafafa;font-weight:bold"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">object is cons box:   0xFF</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">value == nil:         0x80</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">value &lt;= 0x7F:        value</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">size &lt; 0x40:          0x80 | s[0], value</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">size &lt; 0x2000:        0xC0 | s[1], s[0], value</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">size &lt; 0x100000:      0xE0 | s[2], s[1], s[0], value</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">size &lt; 0x8000000:     0xF0 | s[3], s[2], s[1], s[0], value</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">size &lt; 0x400000000:   0xF8 | s[4], s[3], s[2], s[1], s[0], value</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>In the table below, the bits marked x contain the length of the value array, in bytes.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="encoded-size-bytes-layout"></a>Encoded Size bytes layout<a class="hash-link" href="#encoded-size-bytes-layout" title="Direct link to heading">#</a></h3><table><thead><tr><th>Size bytes</th><th>Min Value Len</th><th>Max Value Length</th><th>Byte 1</th><th>Byte 2</th><th>Byte 3</th><th>Byte 4</th><th>Byte 5</th></tr></thead><tbody><tr><td>1</td><td>0x00</td><td>0x3F</td><td>1xxxxxxx</td><td></td><td></td><td></td><td></td></tr><tr><td>2</td><td>0x40</td><td>0x1FFF</td><td>11xxxxxx</td><td>xxxxxxxx</td><td></td><td></td><td></td></tr><tr><td>3</td><td>0x2000</td><td>0xFFFFF</td><td>111xxxxx</td><td>xxxxxxxx</td><td>xxxxxxxx</td><td></td><td></td></tr><tr><td>4</td><td>0x100000</td><td>0x7FFFFFF</td><td>1111xxxx</td><td>xxxxxxxx</td><td>xxxxxxxx</td><td>xxxxxxxx</td><td></td></tr><tr><td>5</td><td>0x8000000</td><td>0x3FFFFFFFF</td><td>11111xxx</td><td>xxxxxxxx</td><td>xxxxxxxx</td><td>xxxxxxxx</td><td>xxxxxxxx</td></tr></tbody></table><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="decoding"></a>Decoding<a class="hash-link" href="#decoding" title="Direct link to heading">#</a></h3><p>The decoding scheme is as follows:</p><p>c[0] is the first byte of the serialized CLVM object.</p><p><strong>size</strong> is the number of bytes contained in the value byte array
<strong>s</strong> is the byte array containing the bytes of the two&#x27;s complement integer size, the number of bytes in the value array.
<strong>value</strong> is the span of bytes describing the CLVM Object itself</p><p>c[0] can contain the entire value, or it can be part of the size header.
Values below 0x80 do not have size header bytes.</p><p>0x00-0x7f: A literal one byte value. c[0] contains the value.
<code>size = 1; value = c[0]</code></p><p>0x80-0xbf: The value starts at the byte c[1], and size is in the lower 6 bits of c[0]
<code>size = (c[0] &amp; 0x3F); value = c[1] .. c[size]</code></p><p>0xc0-0xdf: The value starts at c[2]; the lower 5 bits of c[0] are the high bits of size
<code>size = (c[0] &amp; 0x1F) .. c[1]; value = c[2] .. c[size+1]</code></p><p>0xe0-0xef: The value starts at c[3]; the lower 4 bits of c[0] are the high bits of size
<code>size = (c[0] &amp; 0x0F) .. c[2]; value = c[3] .. c[size+2]</code></p><p>0xf0-0xf7: The value starts at c[4]; the lower 3 bits of c[0] are the high bits of size
<code>size = (c[0] &amp; 0x07) .. c[3]; value = c[4] .. c[size+3]</code></p><p>0xf7-0xfb: The value starts at c[5]; the lower 2 bits of c[0] are the high bits of size
<code>size = (c[0] &amp; 0x03) .. c[4]; value = c[5] .. c[size+4]</code></p><p>Atoms of size 0x400000000 or greater are disallowed in the serialization format.</p><p>As an example:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#383a42;background-color:#fafafa;font-weight:bold"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">c = [ 0x84 0x33 0x22 0x11 0x00 ]</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">c[0] = 0x84</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">size = (0x84 &amp; 0x3F) = 4</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">value = [ 33 22 11 00 ]</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>In the above example, the length of the value is <strong>4</strong>, and we only needed the bottom 3 bits of the c[0] byte to encode the length, so the size is completely described by the first serialized byte. The total length of the encoded atom is 5 bytes.</p><p>Note that for values greater than 0x7F, the bytes of the serialized value representing the length are disjoint with the actual value bytes.</p><p>Let us consider some special cases.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#383a42;background-color:#fafafa;font-weight:bold"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">value(0x80) = 81 80</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>c[0] is <code>0x81</code>.Since c[0] is between <code>0x7F</code> and <code>0xC0</code>, we know that there is only one size byte, c[0], and the value is contained in the following bytes, starting at c[1]. The total size of the value array is
<code>size</code> = <code>c[0] &amp; 0x3F</code> = <code>0x1</code>. So, the full value is contained in the single following byte.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#383a42;background-color:#fafafa;font-weight:bold"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">value(0x81) = 81 81</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">value(0x82) = 81 82</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">value(0xFF) = 81 ff</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Note that the special byte 0xFF is allowed within the bytes representing a value.
0xFF denotes a cons box when it is the first byte of a decoded CLVM object, but it may also occur within the serialized bytes of a value.</p><p>A 2 byte value</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#383a42;background-color:#fafafa;font-weight:bold"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">value(0x01FF) = 82 01 ff</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="lists"></a>Lists<a class="hash-link" href="#lists" title="Direct link to heading">#</a></h3><p>Lists are the primary high-level data structure in most LISP implementations. Traditionally, a LISP builds lists from cons boxes, a two-celled data structure that can be thought of as a struct with two fields, left and right, each of which contains either a value, or a (pointer to) another cons cell.</p><p>Because the cons cell is the low level data structure that lists are built from, LISP lists are only lists by way of the fact that lists can be implemented from trees. A lisp list built from cons cells in a binary tree.</p><p>Serialized cons cells are represented by the byte 0xFF, followed by the objects in its cells, left then right.
Values are represented by a variable length byte-aligned encoding scheme, described above.
Nil is chosen to be the zero-length object, which is represented by the byte 0x80.</p><p>Because lists are represented as a sequence of cons boxes, the byte 0xff occurs frequently in the serialization format.</p><p>After the FF introducer byte, the next two values describe what is in the left and right cons boxes, respectively.</p><p>The first examples use single byte values for clarity.</p><p>The list (1 2 3) will be encoded as:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#383a42;background-color:#fafafa;font-weight:bold"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">ff 01 ff 02 ff 03 80</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>This can be read as:</p><p><code>(a cons box containing 01</code> and <code>a cons box (containing 02</code> and <code>a cons box (containing 03 and nil)))</code></p><p>Alternatively, it could be viewed as a binary tree that looks like this:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#383a42;background-color:#fafafa;font-weight:bold"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">      [ ]</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">     /   \</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    1    [ ]</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">         / \</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">        2  [ ]</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">           / \</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">          3  nil</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Or, as a chain of memory cells that look like this:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#383a42;background-color:#fafafa;font-weight:bold"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">(a)[ 1, -&gt;b ]   (b)[ 2, -&gt;c ]   (c)[ 3, nil ]</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Where</p><ul><li>(a) means &quot;The contents of the memory cells at position a and a+1 (cons box a)&quot;</li><li>-&gt;b means &quot;a pointer to cons box (b)&quot;</li><li><code>(a)</code>, <code>(b)</code>, <code>(c)</code> are arbitrary labels for the cons cells, and do not exist in the CLVM</li></ul><p>Because the above list contains only one level of nesting, a single <code>0x80</code> byte is sufficient to terminate the list. Note the two <code>0x80</code> bytes in the example below.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#383a42;background-color:#fafafa;font-weight:bold"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">opc &#x27;(1 (2 3))&#x27;</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">ff 01 ff ff 02 ff 03 80 80</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>There can be many cons cells in a CLVM program, so 0xFF will be common in the serialized program. There will be one serialized nil (0x80) per properly terminated list. Nil may also occur at other places in the program. There are usually more cons boxes than lists, so 0xFF occurs more frequently than 0x80.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><a href="https://github.com/Chia-Network/chialisp-web/edit/main/docs/ref/serialization.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_wj+Z"></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/ref/clvm"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« CLVM Reference</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/puzzles/singletons"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Singletons Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#serialization" class="table-of-contents__link">Serialization</a><ul><li><a href="#values" class="table-of-contents__link">Values</a></li><li><a href="#encoding" class="table-of-contents__link">Encoding</a></li><li><a href="#encoded-size-bytes-layout" class="table-of-contents__link">Encoded Size bytes layout</a></li><li><a href="#decoding" class="table-of-contents__link">Decoding</a></li><li><a href="#lists" class="table-of-contents__link">Lists</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/">CLVM Basics</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/coins_spends_and_wallets/">Coins, Spends and Wallets</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://keybase.io/team/chia_network.public" target="_blank" rel="noopener noreferrer" class="footer__link-item">Keybase</a></li><li class="footer__item"><a href="https://twitter.com/chia_project" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://www.chia.net/blog/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog</a></li><li class="footer__item"><a href="https://github.com/Chia-Network/clvm" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a class="footerLogoLink_SRtH" href="/"><img src="/img/full_logo_white.svg" alt="Chialisp full logo" class="themedImage_TMUO themedImage--light_4Vu1 footer__logo"><img src="/img/full_logo_white.svg" alt="Chialisp full logo" class="themedImage_TMUO themedImage--dark_uzRr footer__logo"></a></div><div class="footer__copyright">Copyright Â© 2021 Chia Network Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.bb342c07.js"></script>
<script src="/assets/js/main.c131b766.js"></script>
</body>
</html>