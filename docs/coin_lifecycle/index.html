<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<title data-react-helmet="true">Lifecycle of a Coin | Chialisp</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://chialisp.com/docs/coin_lifecycle"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Lifecycle of a Coin | Chialisp"><meta data-react-helmet="true" name="description" content="You should now understand how to create Chialisp puzzles that lock up coins with a particular set of rules."><meta data-react-helmet="true" property="og:description" content="You should now understand how to create Chialisp puzzles that lock up coins with a particular set of rules."><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://chialisp.com/docs/coin_lifecycle"><link data-react-helmet="true" rel="alternate" href="https://chialisp.com/docs/coin_lifecycle" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://chialisp.com/docs/coin_lifecycle" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.35749df4.css">
<link rel="preload" href="/assets/js/runtime~main.5582d1e8.js" as="script">
<link rel="preload" href="/assets/js/main.3d802437.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="Chialisp Logo" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/img/logo.svg" alt="Chialisp Logo" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><b class="navbar__title">Chialisp</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a><a href="https://chia.net" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Chia.net<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://github.com/Chia-Network/chialisp-web" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></div><div class="navbar__items navbar__items--right"><div class="react-toggle toggle_2i4l react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_iYfV">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_iYfV">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="navbar__search searchBarContainer_I7kZ"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_Zg7X searchBarLoadingRing_J5Ez"><div></div><div></div><div></div><div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button class="clean-btn backToTopButton_i9tI" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh menuWithAnnouncementBar_+O1J"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Getting Started</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Chialisp</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/">Language Overview</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/common_functions">Common Functions and Design Patterns</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/coins_spends_and_wallets">Coins, Spends and Wallets</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/coin_lifecycle">Lifecycle of a Coin</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/security">Security</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/debugging">Debugging</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/optimization">Optimization</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/standard_transaction">The Standard Transaction</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Standard Puzzles</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Tutorials</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">CLVM</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/docs/glossary">Glossary</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/docs/faq">FAQ</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/docs/resources">Resources</a></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Lifecycle of a Coin</h1></header><p>You should now understand how to create Chialisp puzzles that lock up coins with a particular set of rules.
You may be wondering how a coin gets locked up, where it is stored, how and when it gets spent, and who can spend it.
Let&#x27;s take a look at the steps a coin goes through from its creation to its destruction.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="the-coin-set-model"></a>The Coin Set Model<a class="hash-link" href="#the-coin-set-model" title="Direct link to heading">#</a></h2><p>Chia&#x27;s model of how coins are stored is called the <strong>coin set</strong> model and is closely modelled after Bitcoin&#x27;s UTXO model.
The idea is simple, every full node holds onto a database of <strong>coin records</strong>:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#383a42;background-color:#fafafa;font-weight:bold"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token keyword" style="color:#990096">class</span><span class="token plain"> </span><span class="token class-name" style="color:#006100">Coin</span><span class="token punctuation" style="color:#383a42">:</span><span class="token plain"></span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  parent_coin_info</span><span class="token punctuation" style="color:#383a42">:</span><span class="token plain"> bytes32</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  puzzle_hash</span><span class="token punctuation" style="color:#383a42">:</span><span class="token plain"> bytes32</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  amount</span><span class="token punctuation" style="color:#383a42">:</span><span class="token plain"> uint64</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain"></span><span class="token keyword" style="color:#990096">class</span><span class="token plain"> </span><span class="token class-name" style="color:#006100">CoinRecord</span><span class="token punctuation" style="color:#383a42">:</span><span class="token plain"></span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  coin</span><span class="token punctuation" style="color:#383a42">:</span><span class="token plain"> Coin</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  confirmed_block_index</span><span class="token punctuation" style="color:#383a42">:</span><span class="token plain"> uint32</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  spent_block_index</span><span class="token punctuation" style="color:#383a42">:</span><span class="token plain"> uint32</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  spent</span><span class="token punctuation" style="color:#383a42">:</span><span class="token plain"> boolean</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  coinbase</span><span class="token punctuation" style="color:#383a42">:</span><span class="token plain"> boolean</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  timestamp</span><span class="token punctuation" style="color:#383a42">:</span><span class="token plain"> uint64</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><em>Note that the <code>Coin</code> object is part of the blockchain format and cannot be changed, while the <code>CoinRecord</code> object is part of the full node and can be modified by alternative implementations</em></p><p>This database is generated by looking at the blockchain from block height zero and processing all of the transactions until it is in sync with the current peak.
When a full node processes a spend, it first makes sure that the coin being spent exists in its database, runs and validates the Chialisp conditions that are produced, marks the coin that was being spent as spent, and adds any new coins that were created as a result.</p><p>This approach makes the database very light as the blockchain grows, but still allows for complexity and smart coins through Chialisp which is committed to inside the puzzle hash.
It is also an important distinction from some other blockchains in that <em>all state in Chialisp is stored in the coins</em>.
There is no special way to store data so that people can access it; the majority of that functionality comes from finding ways to reveal the proper information in puzzle reveals and by committing to predictable puzzle hashes.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="farming-rewards"></a>Farming Rewards<a class="hash-link" href="#farming-rewards" title="Direct link to heading">#</a></h2><p>As you probably know, farmers create the entirety of new value in Chia.
Every 18.75 seconds or so, a new block pops into existence that allows for a farmer to create a coin out of thin air, in two amounts of a very specific ratio: 1 to 7 (farmer to pool).
Here are two actual farming rewards that were generated in block 10,000 of the blockchain:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI json"><pre tabindex="0" class="prism-code language-json codeBlock_rtdJ thin-scrollbar" style="color:#383a42;background-color:#fafafa;font-weight:bold"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token punctuation" style="color:#383a42">[</span><span class="token plain"></span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  </span><span class="token punctuation" style="color:#383a42">{</span><span class="token plain"></span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    </span><span class="token property">&quot;amount&quot;</span><span class="token plain"> </span><span class="token operator">:</span><span class="token plain"> </span><span class="token number" style="color:#B35C00;font-weight:normal">1750000000000</span><span class="token punctuation" style="color:#383a42">,</span><span class="token plain"></span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    </span><span class="token property">&quot;parent_coin_info&quot;</span><span class="token plain"> </span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:#B35C00;font-weight:normal">&quot;0xccd5bb71183532bff220ba46c268991a0000000000000000000000000000270b&quot;</span><span class="token punctuation" style="color:#383a42">,</span><span class="token plain"></span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    </span><span class="token property">&quot;puzzle_hash&quot;</span><span class="token plain"> </span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:#B35C00;font-weight:normal">&quot;0x0b42a11b76d276f191026ae1a01c711cc0637e63d8ce0c2f62d6d079cc974920&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  </span><span class="token punctuation" style="color:#383a42">}</span><span class="token punctuation" style="color:#383a42">,</span><span class="token plain"></span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  </span><span class="token punctuation" style="color:#383a42">{</span><span class="token plain"></span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    </span><span class="token property">&quot;amount&quot;</span><span class="token plain"> </span><span class="token operator">:</span><span class="token plain"> </span><span class="token number" style="color:#B35C00;font-weight:normal">250000000000</span><span class="token punctuation" style="color:#383a42">,</span><span class="token plain"></span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    </span><span class="token property">&quot;parent_coin_info&quot;</span><span class="token plain"> </span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:#B35C00;font-weight:normal">&quot;0x3ff07eb358e8255a65c30a2dce0e5fbb0000000000000000000000000000270b&quot;</span><span class="token punctuation" style="color:#383a42">,</span><span class="token plain"></span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    </span><span class="token property">&quot;puzzle_hash&quot;</span><span class="token plain"> </span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:#B35C00;font-weight:normal">&quot;0x0b42a11b76d276f191026ae1a01c711cc0637e63d8ce0c2f62d6d079cc974920&quot;</span><span class="token plain"></span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  </span><span class="token punctuation" style="color:#383a42">}</span><span class="token plain"></span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain"></span><span class="token punctuation" style="color:#383a42">]</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><em>Fun fact: The genesis challenge is the hash of a bitcoin block around the time when the Chia network was launched and the message from Bram Cohen: &quot;&quot;Operational error causes Fed payment system to crash&quot; We stand on the shoulders of giants, now let&#x27;s get farming!&quot;</em></p><p>Notice that the <code>parent_coin_info</code> for both is a little strange.
Because they are created out of thin air, the coins are assigned a special value as their parent coin: one half of the &quot;genesis challenge&quot;, some filler zeroes, and the index of the block they are farmed in.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#383a42;background-color:#fafafa;font-weight:bold"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">pool_parent_id </span><span class="token operator">=</span><span class="token plain"> bytes32</span><span class="token punctuation" style="color:#383a42">(</span><span class="token plain">genesis_challenge</span><span class="token punctuation" style="color:#383a42">[</span><span class="token punctuation" style="color:#383a42">:</span><span class="token number" style="color:#B35C00;font-weight:normal">16</span><span class="token punctuation" style="color:#383a42">]</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> block_height</span><span class="token punctuation" style="color:#383a42">.</span><span class="token plain">to_bytes</span><span class="token punctuation" style="color:#383a42">(</span><span class="token number" style="color:#B35C00;font-weight:normal">16</span><span class="token punctuation" style="color:#383a42">,</span><span class="token plain"> </span><span class="token string" style="color:#B35C00;font-weight:normal">&quot;big&quot;</span><span class="token punctuation" style="color:#383a42">)</span><span class="token punctuation" style="color:#383a42">)</span><span class="token plain"></span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">farmer_parent_id </span><span class="token operator">=</span><span class="token plain"> bytes32</span><span class="token punctuation" style="color:#383a42">(</span><span class="token plain">genesis_challenge</span><span class="token punctuation" style="color:#383a42">[</span><span class="token number" style="color:#B35C00;font-weight:normal">16</span><span class="token punctuation" style="color:#383a42">:</span><span class="token punctuation" style="color:#383a42">]</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> block_height</span><span class="token punctuation" style="color:#383a42">.</span><span class="token plain">to_bytes</span><span class="token punctuation" style="color:#383a42">(</span><span class="token number" style="color:#B35C00;font-weight:normal">16</span><span class="token punctuation" style="color:#383a42">,</span><span class="token plain"> </span><span class="token string" style="color:#B35C00;font-weight:normal">&quot;big&quot;</span><span class="token punctuation" style="color:#383a42">)</span><span class="token punctuation" style="color:#383a42">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>This information is usually not very relevant, but it is used.
For example, in the pooling puzzles, the reward coin needs to make an announcement as it&#x27;s being claimed and another puzzle needs to assert that announcement.
It&#x27;s also important to point out that since the genesis challenge is part of the parent info, and since the genesis challenge is different between mainnet and each testnet, it&#x27;s nearly impossible to end up with two identical coin ids. This is, in part, to prevent signature replay attacks: coins that are signed on testnet won&#x27;t be able to use the same signature on mainnet.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="spend-bundles"></a>Spend Bundles<a class="hash-link" href="#spend-bundles" title="Direct link to heading">#</a></h2><p>Alright, so you&#x27;ve received some XCH and you want to deploy your first smart coin.
To do that, you&#x27;re first going to have to create a <strong>spend bundle</strong>.
This is sometimes referred to colloquially as a &quot;transaction&quot;. A spend bundle is a simple construct.
It is an object that contains exactly two things: a list of coin spends and an aggregated signature.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#383a42;background-color:#fafafa;font-weight:bold"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token keyword" style="color:#990096">class</span><span class="token plain"> </span><span class="token class-name" style="color:#006100">SpendBundle</span><span class="token punctuation" style="color:#383a42">:</span><span class="token plain"></span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  coin_spends</span><span class="token punctuation" style="color:#383a42">:</span><span class="token plain"> List</span><span class="token punctuation" style="color:#383a42">[</span><span class="token plain">CoinSpend</span><span class="token punctuation" style="color:#383a42">]</span><span class="token plain"></span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  aggregated_signature</span><span class="token punctuation" style="color:#383a42">:</span><span class="token plain"> G2Element</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>A <strong>coin spend</strong> contains exactly three things: The coin you are trying to spend (parent_coin_info, amount, puzzle_hash), the puzzle reveal (needs to tree hash to the puzzle hash), and the solution.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#383a42;background-color:#fafafa;font-weight:bold"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token keyword" style="color:#990096">class</span><span class="token plain"> </span><span class="token class-name" style="color:#006100">CoinSpend</span><span class="token punctuation" style="color:#383a42">:</span><span class="token plain"></span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  coin</span><span class="token punctuation" style="color:#383a42">:</span><span class="token plain"> Coin</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  puzzle_reveal</span><span class="token punctuation" style="color:#383a42">:</span><span class="token plain"> SerializedProgram</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  solution</span><span class="token punctuation" style="color:#383a42">:</span><span class="token plain"> SerializedProgram</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>The <strong>aggregated signature</strong> is a BLS signature and needs to be a signature of exactly the public key/message pairs that are output by the conditions from puzzles in the bundle.
You cannot aggregate extra signatures, nor can you leave out any.
If there are no AGG_SIG_ME or AGG_SIG_UNSAFE conditions that are output, the aggregated signature must be an empty signature which is a &quot;c&quot; followed 191 zeroes.</p><p>Once you have constructed a spend bundle, you can push it to the <code>/push_tx</code> RPC endpoint on a Chia full node.
Keep in mind a few things though:</p><ul><li>Unless you farm the block, you cannot guarantee if or when your spend bundle will make it to the network.
If two spends rely on each other some way, they must be in the same spend bundle and bound with signatures.</li><li>When using short absolute timelocks, make sure to leave in a reasonable amount of time for the bundle to reach the network.
Sometimes, due to high fee pressure, it may take a while for a low fee transaction to get in.
If your spend relies on having the coin available on the blockchain before the timelock passes, it&#x27;s not a guarantee, so make sure to leave in a good amount of time just in case.</li><li>Nothing technically keeps the spends in a spend bundle together except for the aggregated signature and announcement logic.
If you make a spend that does not assert an announcement from another coin in the spend AND does not require a signature, that spend can be excluded from the bundle by a malicious node or farmer.
Also note that a spend bundle can be aggregated with another without your permission.
In fact, the block creation code does something similar when it creates the generator, which we will talk about soon.</li></ul><p>Remember that other nodes are handling this piece of data as well, and it&#x27;s best to assume that they will try to change everything that they can.
Make sure that if anything changes in a way you don&#x27;t like, the whole bundle will fail.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="fees-and-the-mempool"></a>Fees and the Mempool<a class="hash-link" href="#fees-and-the-mempool" title="Direct link to heading">#</a></h2><p>Once you create and push a spend bundle, your node will validate it and then start gossiping the information out to its peers.
When each node receives a transaction it tries to validate it on its own and will reject it if it considers the spend to be invalid.
It is <em>extremely</em> important to note that before it validates it, the node can run software that tries to change it.
This is why it&#x27;s very important that you create your spend bundles in a way that any changes will automatically invalidate the signature or the puzzle hash.
The malicious node can push the changed transaction to other honest nodes, and if it&#x27;s not invalid, the honest nodes will accept it.</p><p>Once it has validated the spend bundle, it will include the relevant information into its <strong>mempool</strong>.
The mempool is a list of transactions that a node is holding onto and waiting to put into a block.
Items in the mempool are sorted by <strong>fees</strong>.
A fee is created when the sum of the <code>CREATE_COIN</code> outputs is less than the amount of the coin that is being spent.
This means that no value can ever be destroyed in the Chia ecosystem: if you spend a coin and don&#x27;t create any new coins, the farmer can add the value of the existing coin to their farming rewards.</p><p>When the mempool is deciding which transactions to put into a block, it looks to put in the transactions with the highest fee / cost ratio.
We haven&#x27;t talked much about cost yet, but you can find out more about it <a href="/docs/ref/clvm#costs">here</a> and we&#x27;ll talk about optimization more in a later section.
The main idea is: if you make a complex and hard to run transaction with a lot of data, you will probably end up paying a higher fee to get it into a block in a reasonable time frame.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="transaction-generators"></a>Transaction Generators<a class="hash-link" href="#transaction-generators" title="Direct link to heading">#</a></h2><p>When a farmer decides to include transactions in a block, they will aggregate all of them into something called a <strong>transaction generator</strong>.
A generator is a clvm program that outputs the information in the spend bundle.
It will result in a list of lists that contain:</p><ul><li>The parent ID of the coin being spent</li><li>The puzzle and solution reveals</li><li>The coin amount</li></ul><p>That program is then run through <a href="https://github.com/Chia-Network/chia-blockchain/blob/59de4ffe9f98de62d281695d1f519d65ef2e2ece/chia/wallet/puzzles/rom_bootstrap_generator.clvm" target="_blank" rel="noopener noreferrer">another Chialisp program</a> that is a part of consensus and is used when validating every block that a node receives.
That program parses the generator for puzzle and solution reveals, and returns a total list of conditions for every transaction in the block.</p><p>This is an important concept: <em>all transactions in a block are run in parallel</em>.
The fact that all of these transactions are evaluated as one big program provides some valuable benefits:</p><p>Farmers cannot front-run a transaction at farm time because there is no order to the transactions.
They can kick transactions and spend the coins that the kicked transactions were planning to spend if they&#x27;d like, but they cannot then add the transaction back into the set because the coin it <em>was</em> spending is now already spent.</p><p>Also, since all transactions are returned as a single list of conditions, your conditions can potentially rely on <em>announcements from other transactions</em>.
If you know that a spend frequently happens that creates an announcement, your puzzles can assert that announcement without being the owner of that transaction!  This is a potential implementation for oracles on the Chia Network.
An entity can create a <strong>singleton</strong>, or a coin that there is verifiably only one of, and can make announcements every block that puzzles reliant on the announcements can assert.</p><p>Furthermore, generators also enable the compression of certain puzzles in a block to reduce their cost.
This is entirely dependent on the farmers to make this compression happen, and as a Chialisp developer you don&#x27;t have much control over it.
However, it does incentivize the use of those specific compress-able puzzles.
For example, when farmers create a block with the <a href="/docs/standard_transaction">standard transaction</a> format in them, they can compress those transactions down to a single pubkey and a reference of a block to look in to find the full uncompressed puzzle.
If you look at the standard puzzle and decide that it&#x27;s too complex to use as an inner puzzle for a puzzle you are writing, you may try to make a simpler puzzle to save cost.
However, you may actually end up paying more cost because your puzzle may not be compressed whereas the standard transaction will!</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="conclusion"></a>Conclusion<a class="hash-link" href="#conclusion" title="Direct link to heading">#</a></h2><p>You should now have a pretty decent grasp of the environment that your puzzles will be running in.
Writing secure Chialisp puzzles requires a somewhat unique way of looking at things that is not shared by many other programming languages or blockchains.
Understanding of the network is inextricably intertwined with the creation of puzzles and while that creates a steep learning curve, it also enables incredible functionality in an incredibly compact format.</p><p>It is highly recommended that you fully understand this section before you decide to deploy any smart coin so that you can ensure they are secure and functional.
Simply running the puzzle on your computer is no substitute for having it run on millions of nodes with indeterminable intent.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/Chia-Network/chialisp-web/edit/main/docs/coin_lifecycle.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/coins_spends_and_wallets"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Coins, Spends and Wallets</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/security"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Security Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#the-coin-set-model" class="table-of-contents__link">The Coin Set Model</a></li><li><a href="#farming-rewards" class="table-of-contents__link">Farming Rewards</a></li><li><a href="#spend-bundles" class="table-of-contents__link">Spend Bundles</a></li><li><a href="#fees-and-the-mempool" class="table-of-contents__link">Fees and the Mempool</a></li><li><a href="#transaction-generators" class="table-of-contents__link">Transaction Generators</a></li><li><a href="#conclusion" class="table-of-contents__link">Conclusion</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/ref/clvm">CLVM Reference</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://developers.chia.net/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Chia Developers Forum<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://keybase.io/team/chia_network.public" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Keybase<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://twitter.com/chia_project" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://www.chia.net/blog/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/Chia-Network/clvm" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a class="footerLogoLink_SRtH" href="/"><img src="/img/full_logo_white.svg" alt="Chialisp full logo" class="themedImage_TMUO themedImage--light_4Vu1 footer__logo"><img src="/img/full_logo_white.svg" alt="Chialisp full logo" class="themedImage_TMUO themedImage--dark_uzRr footer__logo"></a></div><div class="footer__copyright">Â© 2022 Chia Network Inc., Licensed under the <a href="https://github.com/Chia-Network/chialisp-web/blob/main/LICENSE" target="_blank">Apache License, Version 2.0</a> | <a href="https://www.chia.net/terms">Terms</a></div></div></div></footer></div>
<script src="/assets/js/runtime~main.5582d1e8.js"></script>
<script src="/assets/js/main.3d802437.js"></script>
</body>
</html>