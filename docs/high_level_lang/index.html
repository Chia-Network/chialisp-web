<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.2">
<title data-react-helmet="true">4 - The High Level Language, Compiler, and Functions | Chialisp</title><meta data-react-helmet="true" property="og:url" content="https://chialisp.com/docs/high_level_lang"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="4 - The High Level Language, Compiler, and Functions | Chialisp"><meta data-react-helmet="true" name="description" content="This guide assumes that you have already read the previous parts."><meta data-react-helmet="true" property="og:description" content="This guide assumes that you have already read the previous parts."><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://chialisp.com/docs/high_level_lang"><link data-react-helmet="true" rel="alternate" href="https://chialisp.com/docs/high_level_lang" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://chialisp.com/docs/high_level_lang" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.ba3c1805.css">
<link rel="preload" href="/assets/js/runtime~main.3ca54f74.js" as="script">
<link rel="preload" href="/assets/js/main.f3ac9d45.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="Chialisp Logo" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/img/logo.svg" alt="Chialisp Logo" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><b class="navbar__title">Chialisp</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a><a href="https://chialisp.com/training" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Training<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://chia.net" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Chia.net<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://github.com/Chia-Network/chialisp-web" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></div><div class="navbar__items navbar__items--right"><div class="react-toggle displayOnlyInLargeViewport_cxYs react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_iYfV">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_iYfV">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="navbar__search searchBarContainer_I7kZ"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_Zg7X searchBarLoadingRing_J5Ez"><div></div><div></div><div></div><div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="Chialisp Logo" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/img/logo.svg" alt="Chialisp Logo" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><b class="navbar__title">Chialisp</b></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/">Docs</a></li><li class="menu__list-item"><a href="https://chialisp.com/training" target="_blank" rel="noopener noreferrer" class="menu__link"><span>Training<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="menu__list-item"><a href="https://chia.net" target="_blank" rel="noopener noreferrer" class="menu__link"><span>Chia.net<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="menu__list-item"><a href="https://github.com/Chia-Network/chialisp-web" target="_blank" rel="noopener noreferrer" class="menu__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_lDyR"><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu menu--responsive thin-scrollbar menu_cyFh menuWithAnnouncementBar_+O1J" aria-label="Sidebar navigation"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_iZzd" width="24" height="24" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Chialisp</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/">1 - CLVM Basics</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/coins_spends_and_wallets">2 - Coins, Spends and Wallets</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/deeper_into_clvm">3 - Deeper into CLVM</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/high_level_lang">4 - The High Level Language, Compiler, and Functions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/common_functions">5 - Common Functions in Chialisp</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/standard_transaction">6 - The Standard Transaction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/coin_lifecycle">7 - Lifecycle of a Coin</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/security">8 - Security</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/debugging">9 - Debugging</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/optimization">10 - Optimization</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/glossary">The Great Chia Glossary</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">CLVM</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ref/clvm">CLVM Reference</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/ref/serialization">Serialization</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Puzzles</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/puzzles/singletons">Singletons</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/puzzles/pooling">Pooling</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/puzzles/cats">Chia Asset Tokens (CATs)</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Tutorials</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tutorials/why_chia_is_great">Why Chia is Great</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tutorials/developing_applications">An Overview of Developing Applications on Chia</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tutorials/tools_and_setup">Tools and Setup</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tutorials/programming_chialisp">Programming in Chialisp</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tutorials/coin_lifecycle_and_testing">Coin Lifecycle and Testing</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tutorials/singletons">Singletons and Ethereum-like Contracts in Chia</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tutorials/high-level-tips-1">High Level Tips - Managing State, Coin Creation, Announcements</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tutorials/high-level-tips-2">High Level Tips - Security, Checking Arguments &amp; Signatures</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tutorials/high-level-tips-3">High Level Tips - Announcements, Oracles</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tutorials/custom_puzzle_lock">Lock a coin with a custom puzzle</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tutorials/coin_spend_rpc">Spend a coin using RPC</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tutorials/structure_of_a_chia_application">Structure of a Chia Application</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tutorials/CAT_Launch_Process_Linux_MacOS">CAT creation tutorial (Linux/MacOS)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tutorials/CAT_Launch_Process_Windows">CAT creation tutorial (Windows)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tutorials/single_issuance_CAT">Single Issuance CAT</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/tutorials/multiple_issuance_CAT">Multiple Issuance CAT</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">FAQ</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/faq">ChiaLisp and CLVM FAQ</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="markdown"><header><h1 class="h1Heading_dC7a">4 - The High Level Language, Compiler, and Functions</h1></header><p>This guide assumes that you have already read the previous parts.
It is highly recommended that you do so as the higher level language is built directly on top of the lower level language.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="clvm-vs-chialisp"></a>CLVM vs Chialisp<a class="hash-link" href="#clvm-vs-chialisp" title="Direct link to heading">#</a></h2><p>Until now, we have been using what we call CLVM to write our programs.
CLVM is what is serialized and stored directly on the blockchain and is a matter of consensus. It can never be changed.</p><p>Normally, we will write a higher level language called <strong>Chialisp</strong> instead of CLVM.
Chialisp compiles into CLVM, and since it is going through the compiler first, it can actually be changed to add more features.
Chialisp shares a lot of the fundamentals of how programs work with CLVM, but also includes some helpful functionality to make writing large programs easier.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="run"></a>Run<a class="hash-link" href="#run" title="Direct link to heading">#</a></h2><p>The first difference you need to be aware of for the higher level language is that you should call <code>run</code> instead of <code>brun</code>.
This lets the runtime know that it should be including higher level operators and behavior.</p><p>The first higher level feature you should be aware of is that <strong>it is no longer necessary to quote atoms!</strong></p><p>Compare <code>brun</code> and <code>run</code> here:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI chialisp"><pre tabindex="0" class="prism-code language-chialisp codeBlock_rtdJ thin-scrollbar" style="color:#383a42;background-color:#fafafa;font-weight:bold"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">$ brun &#x27;(+ 200 200)&#x27;</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">FAIL: first of non-cons ()</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">$ run &#x27;(+ 200 200)&#x27;</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">400</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Run also gives us access to a number of convenient high level operators, which we will cover now.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="list"></a>list<a class="hash-link" href="#list" title="Direct link to heading">#</a></h2><p><code>list</code> takes any number of parameters and returns them put inside a list.
This saves us from having to manually create nested <code>(c (A) (c (B) (q ())))</code> calls, which can get messy quickly.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI chialisp"><pre tabindex="0" class="prism-code language-chialisp codeBlock_rtdJ thin-scrollbar" style="color:#383a42;background-color:#fafafa;font-weight:bold"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">$ run &#x27;(list 100 &quot;test&quot; 0xdeadbeef)&#x27;</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">(100 &quot;test&quot; 0xdeadbeef)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="if"></a>if<a class="hash-link" href="#if" title="Direct link to heading">#</a></h2><p><code>if</code> automatically puts our <code>i</code> statement into the lazy evaluation form so we do not need to worry about the unused code path being evaluated.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI chialisp"><pre tabindex="0" class="prism-code language-chialisp codeBlock_rtdJ thin-scrollbar" style="color:#383a42;background-color:#fafafa;font-weight:bold"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">$ run &#x27;(if 1 (q . &quot;success&quot;) (x))&#x27; &#x27;(100)&#x27;</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">&quot;success&quot;</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">$ run &#x27;(if 0 (q . &quot;success&quot;) (x))&#x27; &#x27;(100)&#x27;</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">FAIL: clvm raise ()</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="qq-unquote"></a>qq unquote<a class="hash-link" href="#qq-unquote" title="Direct link to heading">#</a></h2><p><code>qq</code> allows us to quote something with selected portions being evaluated inside by using <code>unquote</code>.
The advantages of this may not be immediately obvious but are extremely useful in practice as it allows us to substitute out sections of predetermined code.</p><p>Suppose we are writing a program that returns another coin&#x27;s puzzle.
We know that a puzzle takes the form: <code>(c (c (q . 50) (c (q . 0xpubkey) (c (sha256 2) (q . ())))) (a 5 11))</code>
However we will want to change 0xpubkey to a value passed to us through our solution.</p><p><strong>Note: <code>@</code> allows us to access the arguments in the higher level language (<code>@</code> == 1)</strong></p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI chialisp"><pre tabindex="0" class="prism-code language-chialisp codeBlock_rtdJ thin-scrollbar" style="color:#383a42;background-color:#fafafa;font-weight:bold"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">$ run &#x27;(qq (c (c (q . 50) (c (q (unquote (f @))) (c (sha256 2) ()))) (a 5 11)))&#x27; &#x27;(0xdeadbeef)&#x27;</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">(c (c (q . 50) (c (q . 0xdeadbeef) (c (sha256 2) ()))) (a 5 11))</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="compiling-to-clvm-with-mod"></a>Compiling to CLVM with Mod<a class="hash-link" href="#compiling-to-clvm-with-mod" title="Direct link to heading">#</a></h2><p>It is important to remember that in practice smart coins will run using the lower level language, so none of the above operators will work on the network.
What we <em>can</em> do however is compile them down to the lower level language.
This is where <code>mod</code> comes in.
<code>mod</code> is an operator that lets the runtime know that it needs to be compiling the code rather than actually running it.</p><p><code>(mod A B)</code> takes two or more parameters. The first is used to name parameters that are passed in, and the last is the higher level script which is to be compiled.</p><p>Below we name our arguments <code>arg_one</code> and <code>arg_two</code> and then access <code>arg_one</code> inside our main program</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI chialisp"><pre tabindex="0" class="prism-code language-chialisp codeBlock_rtdJ thin-scrollbar" style="color:#383a42;background-color:#fafafa;font-weight:bold"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">$ run &#x27;(mod (arg_one arg_two) (list arg_one))&#x27;</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">(c 2 ())</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>As you can see it returns our program in compiled lower level form.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI chialisp"><pre tabindex="0" class="prism-code language-chialisp codeBlock_rtdJ thin-scrollbar" style="color:#383a42;background-color:#fafafa;font-weight:bold"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">$ brun &#x27;(c 2 ())&#x27; &#x27;(100 200 300)&#x27;</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">(100)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>You may be wondering what other parameters <code>mod</code> takes, between variable names and source code.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="functions-macros-and-constants"></a>Functions, Macros and Constants<a class="hash-link" href="#functions-macros-and-constants" title="Direct link to heading">#</a></h2><p>In the higher level language we can define functions, macros, and constants before our program by using <code>defun</code>, <code>defun-inline</code>, <code>defmacro</code> and <code>defconstant</code>.</p><p>We can define as many of these as we like before the main source code.
Usually a program will be structured like this:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI chialisp"><pre tabindex="0" class="prism-code language-chialisp codeBlock_rtdJ thin-scrollbar" style="color:#383a42;background-color:#fafafa;font-weight:bold"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">(mod (arg_one arg_two)</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  (defconstant const_name value)</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  (defun function_name (parameter_one parameter_two) *function_code*)</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  (defun another_function (param_one param_two param_three) *function_code*)</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  (defun-inline utility_function (param_one param_two) *function_code*)</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  (defmacro macro_name (param_one param_two) *macro_code*)</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  (main *program*)</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>A few things to note:</p><ul><li>Functions can reference themselves in their code but macros and inlines cannot as they are inserted at compile time.</li><li>Both functions and macros can reference other functions, macros and constants.</li><li>Macros that refer to their parameters must be quasiquoted with the parameters unquoted</li><li>Be careful of infinite loops in macros that reference other macros.</li><li>Comments can be written with semicolons</li><li>Inline functions are generally more cost effective than regular functions except when reusing calculated arguments: <code>(defun-inline foo (X) (+ X X)) (foo (* 200 300))</code> will perform the expensive multiplication twice</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="factorial"></a>Factorial<a class="hash-link" href="#factorial" title="Direct link to heading">#</a></h2><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI chialisp"><pre tabindex="0" class="prism-code language-chialisp codeBlock_rtdJ thin-scrollbar" style="color:#383a42;background-color:#fafafa;font-weight:bold"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">(mod (arg_one)</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  ; function definitions</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  (defun factorial (input)</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    (if (= input 1) 1 (* (factorial (- input 1)) input))</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  )</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  ; main</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  (factorial arg_one)</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>We can save these files to .clvm files which can be run from the command line.
Saving the above example as <code>factorial.clvm</code> allows us to do the following.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI chialisp"><pre tabindex="0" class="prism-code language-chialisp codeBlock_rtdJ thin-scrollbar" style="color:#383a42;background-color:#fafafa;font-weight:bold"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">$ run factorial.clvm</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">(a (q 2 2 (c 2 (c 5 ()))) (c (q 2 (i (= 5 (q . 1)) (q 1 . 1) (q 18 (a 2 (c 2 (c (- 5 (q . 1)) ()))) 5)) 1) 1))</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">$ brun &#x27;(a (q 2 2 (c 2 (c 5 ()))) (c (q 2 (i (= 5 (q . 1)) (q 1 . 1) (q 18 (a 2 (c 2 (c (- 5 (q . 1)) ()))) 5)) 1) 1))&#x27; &#x27;(5)&#x27;</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">120</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="squaring-a-list"></a>Squaring a List<a class="hash-link" href="#squaring-a-list" title="Direct link to heading">#</a></h2><p>Now lets do an example which uses macros as well.
When writing a macro it must be quasiquoted with the parameters being unquoted.</p><p>We can also take this time to show another feature of the compiler.
You can name each parameter in a list or you can name the list itself.
This works at any place where you name parameters, and allows you to handle lists where you aren&#x27;t sure of the size.</p><p>Here we define a macro to square a parameter and then a function to square a list.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI chialisp"><pre tabindex="0" class="prism-code language-chialisp codeBlock_rtdJ thin-scrollbar" style="color:#383a42;background-color:#fafafa;font-weight:bold"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">(mod (args)</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  (defmacro square (input)</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    (qq (* (unquote input) (unquote input)))</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  )</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  (defun sqre_list (my_list)</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    (if my_list</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">      (c (square (f my_list)) (sqre_list (r my_list)))</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">      my_list</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    )</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  )</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">  (sqre_list args)</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Compiling and running this code results in this:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI chialisp"><pre tabindex="0" class="prism-code language-chialisp codeBlock_rtdJ thin-scrollbar" style="color:#383a42;background-color:#fafafa;font-weight:bold"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">$ run square_list.clvm</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">(a (q 2 2 (c 2 (c 5 ()))) (c (q 2 (i 5 (q 4 (* 9 9) (a 2 (c 2 (c 13 ())))) (q . 5)) 1) 1))</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">$ brun &#x27;(a (q 2 2 (c 2 (c 5 ()))) (c (q 2 (i 5 (q 4 (* 9 9) (a 2 (c 2 (c 13 ())))) (q . 5)) 1) 1))&#x27; &#x27;((10 9 8 7))&#x27;</span></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">(100 81 64 49)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="conclusion"></a>Conclusion<a class="hash-link" href="#conclusion" title="Direct link to heading">#</a></h2><p>You should now have the context and knowledge needed to write your own Chialisp programs.
Remember from <a href="/docs/coins_spends_and_wallets/">our discussion of coins</a> that these programs run on the blockchain and instruct the blockchain what to do with the coin&#x27;s value.</p><p>If you have further questions feel free to ask on <a href="https://keybase.io/team/chia_network.public" target="_blank" rel="noopener noreferrer">Keybase</a>.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><a href="https://github.com/Chia-Network/chialisp-web/edit/main/docs/high_level_lang.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_wj+Z"></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/deeper_into_clvm"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« 3 - Deeper into CLVM</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/common_functions"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">5 - Common Functions in Chialisp Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#clvm-vs-chialisp" class="table-of-contents__link">CLVM vs Chialisp</a></li><li><a href="#run" class="table-of-contents__link">Run</a></li><li><a href="#list" class="table-of-contents__link">list</a></li><li><a href="#if" class="table-of-contents__link">if</a></li><li><a href="#qq-unquote" class="table-of-contents__link">qq unquote</a></li><li><a href="#compiling-to-clvm-with-mod" class="table-of-contents__link">Compiling to CLVM with Mod</a></li><li><a href="#functions-macros-and-constants" class="table-of-contents__link">Functions, Macros and Constants</a></li><li><a href="#factorial" class="table-of-contents__link">Factorial</a></li><li><a href="#squaring-a-list" class="table-of-contents__link">Squaring a List</a></li><li><a href="#conclusion" class="table-of-contents__link">Conclusion</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/">CLVM Basics</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/coins_spends_and_wallets/">Coins, Spends and Wallets</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://keybase.io/team/chia_network.public" target="_blank" rel="noopener noreferrer" class="footer__link-item">Keybase</a></li><li class="footer__item"><a href="https://twitter.com/chia_project" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://www.chia.net/blog/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog</a></li><li class="footer__item"><a href="https://github.com/Chia-Network/clvm" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a class="footerLogoLink_SRtH" href="/"><img src="/img/full_logo_white.svg" alt="Chialisp full logo" class="themedImage_TMUO themedImage--light_4Vu1 footer__logo"><img src="/img/full_logo_white.svg" alt="Chialisp full logo" class="themedImage_TMUO themedImage--dark_uzRr footer__logo"></a></div><div class="footer__copyright">Copyright Â© 2022 Chia Network Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.3ca54f74.js"></script>
<script src="/assets/js/main.f3ac9d45.js"></script>
</body>
</html>